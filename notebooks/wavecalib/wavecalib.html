
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>C distortion and wavelength calibration &#8212; Teareduce cookbook</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script type="application/vnd.jupyter.widget-state+json">{"state": {"a7d63b4930924ba5a69b9f56713a2af8": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "ad9796891da7457aadb8889b8846d53d": {"model_name": "ProgressStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ProgressStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "bar_color": null, "description_width": ""}}, "619b82f6875c44279ee203461df5789e": {"model_name": "FloatProgressModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "FloatProgressModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "ProgressView", "bar_style": "success", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_a7d63b4930924ba5a69b9f56713a2af8", "max": 250.0, "min": 0.0, "orientation": "horizontal", "style": "IPY_MODEL_ad9796891da7457aadb8889b8846d53d", "tabbable": null, "tooltip": null, "value": 250.0}}, "58dc00b8bc144dd6b84d7810d2e082d8": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "482ed68fb1284f2eaecff86c0c379d90": {"model_name": "HTMLStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "b40d1e474f5a424cb20e9ecb30a2c191": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_58dc00b8bc144dd6b84d7810d2e082d8", "placeholder": "\u200b", "style": "IPY_MODEL_482ed68fb1284f2eaecff86c0c379d90", "tabbable": null, "tooltip": null, "value": "Finding\u2007peaks:\u2007100%"}}, "21dace618a474747b7960928b17da2f6": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "eeaf52270c3748c883d0bbf5199c576b": {"model_name": "HTMLStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "b90f45ad32de42a2967bf82ff8ab6a7d": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_21dace618a474747b7960928b17da2f6", "placeholder": "\u200b", "style": "IPY_MODEL_eeaf52270c3748c883d0bbf5199c576b", "tabbable": null, "tooltip": null, "value": "\u2007250/250\u2007[00:00&lt;00:00,\u2007347.28it/s]"}}, "35e500cb92dc404dbb0e0c0d9da25112": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "0c88bf3f42404262998c7fbceaecbc7f": {"model_name": "HBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_b40d1e474f5a424cb20e9ecb30a2c191", "IPY_MODEL_619b82f6875c44279ee203461df5789e", "IPY_MODEL_b90f45ad32de42a2967bf82ff8ab6a7d"], "layout": "IPY_MODEL_35e500cb92dc404dbb0e0c0d9da25112", "tabbable": null, "tooltip": null}}, "03fbfde742af4a37b8d77b7623559e07": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "15d64bd16aab4bf3917542a3cc65c4ef": {"model_name": "ProgressStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ProgressStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "bar_color": null, "description_width": ""}}, "2429c6764bb94f35bfbd38e31d6e466c": {"model_name": "FloatProgressModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "FloatProgressModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "ProgressView", "bar_style": "success", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_03fbfde742af4a37b8d77b7623559e07", "max": 80.0, "min": 0.0, "orientation": "horizontal", "style": "IPY_MODEL_15d64bd16aab4bf3917542a3cc65c4ef", "tabbable": null, "tooltip": null, "value": 80.0}}, "a4ed0b0e5972446a9d66b8b3f6bb2751": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "ac79789cf950492d84b6b0833c117562": {"model_name": "HTMLStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "eafada34d41c46768ec0874206e84c9d": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_a4ed0b0e5972446a9d66b8b3f6bb2751", "placeholder": "\u200b", "style": "IPY_MODEL_ac79789cf950492d84b6b0833c117562", "tabbable": null, "tooltip": null, "value": "Finding\u2007peaks:\u2007100%"}}, "3ea348e520d940ce8c318981e1306faa": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "33cb92cce92a4fe4a5c9845f8f663974": {"model_name": "HTMLStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "303aceae71254c4aac0411fa57081f8c": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_3ea348e520d940ce8c318981e1306faa", "placeholder": "\u200b", "style": "IPY_MODEL_33cb92cce92a4fe4a5c9845f8f663974", "tabbable": null, "tooltip": null, "value": "\u200780/80\u2007[00:00&lt;00:00,\u2007330.53it/s]"}}, "5aeb0a7c38174e4981debd1baf2cd8ac": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "db1d668b13e54c048482cfd05daae867": {"model_name": "HBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_eafada34d41c46768ec0874206e84c9d", "IPY_MODEL_2429c6764bb94f35bfbd38e31d6e466c", "IPY_MODEL_303aceae71254c4aac0411fa57081f8c"], "layout": "IPY_MODEL_5aeb0a7c38174e4981debd1baf2cd8ac", "tabbable": null, "tooltip": null}}, "32088c98beee42059f70c2705f0287cf": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "cf9013b2d71b4c169eeb1269c75adc28": {"model_name": "ProgressStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ProgressStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "bar_color": null, "description_width": ""}}, "ccdc762490d64a2c962243a7db2f1506": {"model_name": "FloatProgressModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "FloatProgressModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "ProgressView", "bar_style": "success", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_32088c98beee42059f70c2705f0287cf", "max": 61.0, "min": 0.0, "orientation": "horizontal", "style": "IPY_MODEL_cf9013b2d71b4c169eeb1269c75adc28", "tabbable": null, "tooltip": null, "value": 61.0}}, "b17596df62194086bd576b0dba568e16": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "c5fccc0f1104424d919d11665418d277": {"model_name": "HTMLStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "9f2498b1e2d14668ac06a5ab24a4b611": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_b17596df62194086bd576b0dba568e16", "placeholder": "\u200b", "style": "IPY_MODEL_c5fccc0f1104424d919d11665418d277", "tabbable": null, "tooltip": null, "value": "Finding\u2007peaks:\u2007100%"}}, "b51f22caa6234f5ba6c7fa6921040212": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "36a84c3870dd4502aace172ae70ff6a6": {"model_name": "HTMLStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "30089d6a51e6433796f62de5ea5aa937": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_b51f22caa6234f5ba6c7fa6921040212", "placeholder": "\u200b", "style": "IPY_MODEL_36a84c3870dd4502aace172ae70ff6a6", "tabbable": null, "tooltip": null, "value": "\u200761/61\u2007[00:00&lt;00:00,\u2007328.00it/s]"}}, "caf763e0665141e0a1037e90caa859aa": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "280206c740364f76bb88bc68e96e99fb": {"model_name": "HBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_9f2498b1e2d14668ac06a5ab24a4b611", "IPY_MODEL_ccdc762490d64a2c962243a7db2f1506", "IPY_MODEL_30089d6a51e6433796f62de5ea5aa937"], "layout": "IPY_MODEL_caf763e0665141e0a1037e90caa859aa", "tabbable": null, "tooltip": null}}, "342bfae8931d4a4eb01aa07c1ea2b653": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "5b9878a6b56b48878fa6a5d4f0e9309a": {"model_name": "ProgressStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ProgressStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "bar_color": null, "description_width": ""}}, "35296d2a4b4f401cb4f100d7b954ae1d": {"model_name": "FloatProgressModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "FloatProgressModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "ProgressView", "bar_style": "success", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_342bfae8931d4a4eb01aa07c1ea2b653", "max": 51.0, "min": 0.0, "orientation": "horizontal", "style": "IPY_MODEL_5b9878a6b56b48878fa6a5d4f0e9309a", "tabbable": null, "tooltip": null, "value": 51.0}}, "4923c411c7ce41f598212fb203618b98": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "8cf48031d4ce49948e697015e300eb1f": {"model_name": "HTMLStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "a4ad739595884026b1fc246ff5ca272a": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_4923c411c7ce41f598212fb203618b98", "placeholder": "\u200b", "style": "IPY_MODEL_8cf48031d4ce49948e697015e300eb1f", "tabbable": null, "tooltip": null, "value": "Finding\u2007peaks:\u2007100%"}}, "179f05cccc49441fbb54a5f53c24f3a3": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "bf9d02f4819042389c9988de7b36aa27": {"model_name": "HTMLStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "54c3cafcf6b349b18c1869915276bfe9": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_179f05cccc49441fbb54a5f53c24f3a3", "placeholder": "\u200b", "style": "IPY_MODEL_bf9d02f4819042389c9988de7b36aa27", "tabbable": null, "tooltip": null, "value": "\u200751/51\u2007[00:00&lt;00:00,\u2007337.07it/s]"}}, "f16a87f056494f23a2475565f0959bad": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "6997e114aff84bc085e51c4cf698d6dd": {"model_name": "HBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_a4ad739595884026b1fc246ff5ca272a", "IPY_MODEL_35296d2a4b4f401cb4f100d7b954ae1d", "IPY_MODEL_54c3cafcf6b349b18c1869915276bfe9"], "layout": "IPY_MODEL_f16a87f056494f23a2475565f0959bad", "tabbable": null, "tooltip": null}}, "a6a7438853ab4048937ffd5aa50dceeb": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "8d8ef4913aff4c1b9bca8750050a1802": {"model_name": "ProgressStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ProgressStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "bar_color": null, "description_width": ""}}, "9271398ab7f745038720b732544c705e": {"model_name": "FloatProgressModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "FloatProgressModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "ProgressView", "bar_style": "success", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_a6a7438853ab4048937ffd5aa50dceeb", "max": 80.0, "min": 0.0, "orientation": "horizontal", "style": "IPY_MODEL_8d8ef4913aff4c1b9bca8750050a1802", "tabbable": null, "tooltip": null, "value": 80.0}}, "1fed7395e0e4443398fb12e878d24cd5": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "e62481a6c226436dbe2c5cc377d0e144": {"model_name": "HTMLStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "554ae0684cac460c997ff7ad805ecb94": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_1fed7395e0e4443398fb12e878d24cd5", "placeholder": "\u200b", "style": "IPY_MODEL_e62481a6c226436dbe2c5cc377d0e144", "tabbable": null, "tooltip": null, "value": "Finding\u2007peaks:\u2007100%"}}, "faed96397f144c1aba3f1552fcc47510": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "9bf33423255e45f3b34c74e12f4f902a": {"model_name": "HTMLStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "2f6dd7dd9dc141cdb4893be2a663aafa": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_faed96397f144c1aba3f1552fcc47510", "placeholder": "\u200b", "style": "IPY_MODEL_9bf33423255e45f3b34c74e12f4f902a", "tabbable": null, "tooltip": null, "value": "\u200780/80\u2007[00:00&lt;00:00,\u2007325.75it/s]"}}, "9e4d3d1dbe544e94a0af4d42cd475752": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "00c17671251f461ab4a0d37db4cabeab": {"model_name": "HBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_554ae0684cac460c997ff7ad805ecb94", "IPY_MODEL_9271398ab7f745038720b732544c705e", "IPY_MODEL_2f6dd7dd9dc141cdb4893be2a663aafa"], "layout": "IPY_MODEL_9e4d3d1dbe544e94a0af4d42cd475752", "tabbable": null, "tooltip": null}}, "c315a02137a54e75963361c3e68be3da": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "35874d14b12045d08bfcebce50478d95": {"model_name": "ProgressStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ProgressStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "bar_color": null, "description_width": ""}}, "929b7309591d44a79810a759c546bdb3": {"model_name": "FloatProgressModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "FloatProgressModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "ProgressView", "bar_style": "success", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_c315a02137a54e75963361c3e68be3da", "max": 61.0, "min": 0.0, "orientation": "horizontal", "style": "IPY_MODEL_35874d14b12045d08bfcebce50478d95", "tabbable": null, "tooltip": null, "value": 61.0}}, "5d39ce91478345bb96da96c9e72219cf": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "571467a6b5db4932921876e648d77094": {"model_name": "HTMLStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "5c1bae8454d843d68e47b0f01407ed3c": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_5d39ce91478345bb96da96c9e72219cf", "placeholder": "\u200b", "style": "IPY_MODEL_571467a6b5db4932921876e648d77094", "tabbable": null, "tooltip": null, "value": "Finding\u2007peaks:\u2007100%"}}, "2139cebabca540b2ab3573d4c75ff9bf": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "39a866c633e04a5f9e5b22e9c1061c6e": {"model_name": "HTMLStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "8414248345954ead9b9903c38b5d82f2": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_2139cebabca540b2ab3573d4c75ff9bf", "placeholder": "\u200b", "style": "IPY_MODEL_39a866c633e04a5f9e5b22e9c1061c6e", "tabbable": null, "tooltip": null, "value": "\u200761/61\u2007[00:00&lt;00:00,\u2007314.23it/s]"}}, "a3451492857f4ac686a16cdb23ea0585": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "8d253a9f674d4ffabcd6b584b81a3588": {"model_name": "HBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_5c1bae8454d843d68e47b0f01407ed3c", "IPY_MODEL_929b7309591d44a79810a759c546bdb3", "IPY_MODEL_8414248345954ead9b9903c38b5d82f2"], "layout": "IPY_MODEL_a3451492857f4ac686a16cdb23ea0585", "tabbable": null, "tooltip": null}}, "2fb6580768b24b54a1d22e884c91eeb4": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "36f86e41d1c8429fb405d71060fdcdd0": {"model_name": "ProgressStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ProgressStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "bar_color": null, "description_width": ""}}, "6c9ddd1652c348719f70d950aae36b4b": {"model_name": "FloatProgressModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "FloatProgressModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "ProgressView", "bar_style": "success", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_2fb6580768b24b54a1d22e884c91eeb4", "max": 51.0, "min": 0.0, "orientation": "horizontal", "style": "IPY_MODEL_36f86e41d1c8429fb405d71060fdcdd0", "tabbable": null, "tooltip": null, "value": 51.0}}, "f4a86be790d3444386bfb6580a58ceca": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "159f6bfec1c241ada5258c3e7b2e62ae": {"model_name": "HTMLStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "c7c9b0aacb2f49849313d320ee1d77a3": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_f4a86be790d3444386bfb6580a58ceca", "placeholder": "\u200b", "style": "IPY_MODEL_159f6bfec1c241ada5258c3e7b2e62ae", "tabbable": null, "tooltip": null, "value": "Finding\u2007peaks:\u2007100%"}}, "d307d635f08548e3abff9e3527ed48ec": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "8071dbf51ab34a94bf8e3ee3defd0773": {"model_name": "HTMLStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "6afbf989b4aa4a0395245e0c58c51e5b": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_d307d635f08548e3abff9e3527ed48ec", "placeholder": "\u200b", "style": "IPY_MODEL_8071dbf51ab34a94bf8e3ee3defd0773", "tabbable": null, "tooltip": null, "value": "\u200751/51\u2007[00:00&lt;00:00,\u2007331.49it/s]"}}, "9c76bcba719d46749c885429c545d452": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "71ffd4dc719d4ab69c8fb495b487a991": {"model_name": "HBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_c7c9b0aacb2f49849313d320ee1d77a3", "IPY_MODEL_6c9ddd1652c348719f70d950aae36b4b", "IPY_MODEL_6afbf989b4aa4a0395245e0c58c51e5b"], "layout": "IPY_MODEL_9c76bcba719d46749c885429c545d452", "tabbable": null, "tooltip": null}}, "deb7aed101274031b56f178ea0e4c5b9": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "306b53dfa7f04505b2af79673282b547": {"model_name": "ProgressStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ProgressStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "bar_color": null, "description_width": ""}}, "2bfa402a6064491ab55632a590f0a371": {"model_name": "FloatProgressModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "FloatProgressModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "ProgressView", "bar_style": "success", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_deb7aed101274031b56f178ea0e4c5b9", "max": 250.0, "min": 0.0, "orientation": "horizontal", "style": "IPY_MODEL_306b53dfa7f04505b2af79673282b547", "tabbable": null, "tooltip": null, "value": 250.0}}, "f4735c1a43964183871ab83d6e724bec": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "0bee244c09644080adc2c06326ee02a1": {"model_name": "HTMLStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "1f58e069fef14a5bb43fb6480c4adb18": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_f4735c1a43964183871ab83d6e724bec", "placeholder": "\u200b", "style": "IPY_MODEL_0bee244c09644080adc2c06326ee02a1", "tabbable": null, "tooltip": null, "value": "Applying\u2007wavelength\u2007calibration:\u2007100%"}}, "05b3ebf59a9c4c6f81f9464303166f02": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "666d6618cb2d41bd9aae2180f4671fab": {"model_name": "HTMLStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "2a727e88b824471d8032643a6212f3c2": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_05b3ebf59a9c4c6f81f9464303166f02", "placeholder": "\u200b", "style": "IPY_MODEL_666d6618cb2d41bd9aae2180f4671fab", "tabbable": null, "tooltip": null, "value": "\u2007250/250\u2007[00:00&lt;00:00,\u200713123.77it/s]"}}, "4624c43cb1a748dda24cf0ab46b90928": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "0f84d1ebae8b42eabf65871e50672cd8": {"model_name": "HBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_1f58e069fef14a5bb43fb6480c4adb18", "IPY_MODEL_2bfa402a6064491ab55632a590f0a371", "IPY_MODEL_2a727e88b824471d8032643a6212f3c2"], "layout": "IPY_MODEL_4624c43cb1a748dda24cf0ab46b90928", "tabbable": null, "tooltip": null}}, "43a23ae23f114c4ca31832f5a77382c8": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "d8d5c8fd9cae4dda85ce4de4caa183d9": {"model_name": "ProgressStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ProgressStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "bar_color": null, "description_width": ""}}, "3338074274ed4a9196c6e4c08a7269e1": {"model_name": "FloatProgressModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "FloatProgressModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "ProgressView", "bar_style": "success", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_43a23ae23f114c4ca31832f5a77382c8", "max": 250.0, "min": 0.0, "orientation": "horizontal", "style": "IPY_MODEL_d8d5c8fd9cae4dda85ce4de4caa183d9", "tabbable": null, "tooltip": null, "value": 250.0}}, "704f96ce9339498a8e3bfa777982c5ae": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "88bebbde9307497fa434a33a30e75276": {"model_name": "HTMLStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "23d64a151a154cad90c72387cfb3cb08": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_704f96ce9339498a8e3bfa777982c5ae", "placeholder": "\u200b", "style": "IPY_MODEL_88bebbde9307497fa434a33a30e75276", "tabbable": null, "tooltip": null, "value": "Applying\u2007wavelength\u2007calibration:\u2007100%"}}, "6729d1d44eb2476f8231b89a65e14d39": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "b40ddaabefb346c38418f9ae8087aae1": {"model_name": "HTMLStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "7d1a59119a7a43d2bc108a7a07a4d7b3": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_6729d1d44eb2476f8231b89a65e14d39", "placeholder": "\u200b", "style": "IPY_MODEL_b40ddaabefb346c38418f9ae8087aae1", "tabbable": null, "tooltip": null, "value": "\u2007250/250\u2007[00:00&lt;00:00,\u200713679.16it/s]"}}, "45fcf8fa773044a2b1a9fd6cd38dac5c": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "acc603497d9c447c8d4fa8461a17632b": {"model_name": "HBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_23d64a151a154cad90c72387cfb3cb08", "IPY_MODEL_3338074274ed4a9196c6e4c08a7269e1", "IPY_MODEL_7d1a59119a7a43d2bc108a7a07a4d7b3"], "layout": "IPY_MODEL_45fcf8fa773044a2b1a9fd6cd38dac5c", "tabbable": null, "tooltip": null}}, "07819822ed0d4530aea540e1bbaee5a4": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "58199b13e8af48adb54d3454ba3b23d5": {"model_name": "ProgressStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ProgressStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "bar_color": null, "description_width": ""}}, "add138bc3e83487ca98b0cc81cb9a3fa": {"model_name": "FloatProgressModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "FloatProgressModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "ProgressView", "bar_style": "success", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_07819822ed0d4530aea540e1bbaee5a4", "max": 250.0, "min": 0.0, "orientation": "horizontal", "style": "IPY_MODEL_58199b13e8af48adb54d3454ba3b23d5", "tabbable": null, "tooltip": null, "value": 250.0}}, "263164107ff5447d9e69a583ace07153": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "fc849da424424ffe955ed57b7f51e02c": {"model_name": "HTMLStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "72a139f065674d269451605494bf492e": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_263164107ff5447d9e69a583ace07153", "placeholder": "\u200b", "style": "IPY_MODEL_fc849da424424ffe955ed57b7f51e02c", "tabbable": null, "tooltip": null, "value": "Finding\u2007peaks:\u2007100%"}}, "f12bcf5e22884c7aa5b4bf79340fad5c": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "2b0dd92344854afab099f565d649e6b5": {"model_name": "HTMLStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "0f4957c9a0cf451689fadb4abafcfdf5": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_f12bcf5e22884c7aa5b4bf79340fad5c", "placeholder": "\u200b", "style": "IPY_MODEL_2b0dd92344854afab099f565d649e6b5", "tabbable": null, "tooltip": null, "value": "\u2007250/250\u2007[00:00&lt;00:00,\u2007345.55it/s]"}}, "04fff257e3c54d7f8d231baf19499c4c": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "6007650e115b4364ba2d8c919b13ce13": {"model_name": "HBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_72a139f065674d269451605494bf492e", "IPY_MODEL_add138bc3e83487ca98b0cc81cb9a3fa", "IPY_MODEL_0f4957c9a0cf451689fadb4abafcfdf5"], "layout": "IPY_MODEL_04fff257e3c54d7f8d231baf19499c4c", "tabbable": null, "tooltip": null}}, "c0b6d8d2d76a4a99a1976fa194f2642e": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "35cfd666deb54356822d864a1550cc3c": {"model_name": "ProgressStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ProgressStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "bar_color": null, "description_width": ""}}, "c61e9b70d009475f9db10eec9350c5d9": {"model_name": "FloatProgressModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "FloatProgressModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "ProgressView", "bar_style": "success", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_c0b6d8d2d76a4a99a1976fa194f2642e", "max": 250.0, "min": 0.0, "orientation": "horizontal", "style": "IPY_MODEL_35cfd666deb54356822d864a1550cc3c", "tabbable": null, "tooltip": null, "value": 250.0}}, "c0b9cac88d96446a83b6e60494deabbb": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "e4ec938d38d9449dbd66f37abcd5e759": {"model_name": "HTMLStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "a30bde044aff4898893aaf137e515cb9": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_c0b9cac88d96446a83b6e60494deabbb", "placeholder": "\u200b", "style": "IPY_MODEL_e4ec938d38d9449dbd66f37abcd5e759", "tabbable": null, "tooltip": null, "value": "Applying\u2007wavelength\u2007calibration:\u2007100%"}}, "e16417acdb744e2180a9eebe4d9f1c63": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "4667ec98df594d828ad0515367d5df58": {"model_name": "HTMLStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "8a1a6f3cab93416794318a6465650d14": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_e16417acdb744e2180a9eebe4d9f1c63", "placeholder": "\u200b", "style": "IPY_MODEL_4667ec98df594d828ad0515367d5df58", "tabbable": null, "tooltip": null, "value": "\u2007250/250\u2007[00:00&lt;00:00,\u200713338.96it/s]"}}, "07fa77afed28483b94c06c80d0af540f": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "d4a213a17d9f4e16b85687d12f30258a": {"model_name": "HBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_a30bde044aff4898893aaf137e515cb9", "IPY_MODEL_c61e9b70d009475f9db10eec9350c5d9", "IPY_MODEL_8a1a6f3cab93416794318a6465650d14"], "layout": "IPY_MODEL_07fa77afed28483b94c06c80d0af540f", "tabbable": null, "tooltip": null}}, "9b0577bc6c204e97a74305dc96f184d0": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "81eb897c256b40fb848770d39517bf95": {"model_name": "ProgressStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ProgressStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "bar_color": null, "description_width": ""}}, "9261de2784cf41988f158ec33497d5c9": {"model_name": "FloatProgressModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "FloatProgressModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "ProgressView", "bar_style": "success", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_9b0577bc6c204e97a74305dc96f184d0", "max": 250.0, "min": 0.0, "orientation": "horizontal", "style": "IPY_MODEL_81eb897c256b40fb848770d39517bf95", "tabbable": null, "tooltip": null, "value": 250.0}}, "a1ce59a9555f41edae205fa9645114f7": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "ef529e3a078b42fea00c626032ed0ac2": {"model_name": "HTMLStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "772a60a2399b4483bcc67f07b68a1699": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_a1ce59a9555f41edae205fa9645114f7", "placeholder": "\u200b", "style": "IPY_MODEL_ef529e3a078b42fea00c626032ed0ac2", "tabbable": null, "tooltip": null, "value": "Applying\u2007wavelength\u2007calibration:\u2007100%"}}, "87c7b87d3a3c4811ae7b0f88680a4c56": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "68700e9287b240588c4c5dc936385a1e": {"model_name": "HTMLStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "f49046e70df647c38f3c6a3baefd60a1": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_87c7b87d3a3c4811ae7b0f88680a4c56", "placeholder": "\u200b", "style": "IPY_MODEL_68700e9287b240588c4c5dc936385a1e", "tabbable": null, "tooltip": null, "value": "\u2007250/250\u2007[00:00&lt;00:00,\u200713545.57it/s]"}}, "76c177a350574ae1babf790e8cbf6aca": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "53f27252523945249dd1d507faf9246d": {"model_name": "HBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_772a60a2399b4483bcc67f07b68a1699", "IPY_MODEL_9261de2784cf41988f158ec33497d5c9", "IPY_MODEL_f49046e70df647c38f3c6a3baefd60a1"], "layout": "IPY_MODEL_76c177a350574ae1babf790e8cbf6aca", "tabbable": null, "tooltip": null}}, "2e8ad6178ec943068838f8dd51eec6ec": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "497ab7f9adbd41e3b785f2a5a35e4e56": {"model_name": "ProgressStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ProgressStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "bar_color": null, "description_width": ""}}, "56312e3c59ef42a0b8c1b00314d2c88e": {"model_name": "FloatProgressModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "FloatProgressModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "ProgressView", "bar_style": "success", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_2e8ad6178ec943068838f8dd51eec6ec", "max": 250.0, "min": 0.0, "orientation": "horizontal", "style": "IPY_MODEL_497ab7f9adbd41e3b785f2a5a35e4e56", "tabbable": null, "tooltip": null, "value": 250.0}}, "50952721653d4ba0ad407d3a1b66987d": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "b1a18e4ff7254d92828da9e6a989944e": {"model_name": "HTMLStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "01b0261e24a84746a13b4b177ff01899": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_50952721653d4ba0ad407d3a1b66987d", "placeholder": "\u200b", "style": "IPY_MODEL_b1a18e4ff7254d92828da9e6a989944e", "tabbable": null, "tooltip": null, "value": "Applying\u2007wavelength\u2007calibration:\u2007100%"}}, "1d53889c7d7648eab6b19882e479beb0": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "61eb9b03eb8c48afba3ce486760b43c1": {"model_name": "HTMLStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "b14936c3673445ef809fe18d38562794": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_1d53889c7d7648eab6b19882e479beb0", "placeholder": "\u200b", "style": "IPY_MODEL_61eb9b03eb8c48afba3ce486760b43c1", "tabbable": null, "tooltip": null, "value": "\u2007250/250\u2007[00:00&lt;00:00,\u200713399.65it/s]"}}, "642bb1a56059491aa5a6be982064f291": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "189c85677df24449af4cfb6836a7455d": {"model_name": "HBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_01b0261e24a84746a13b4b177ff01899", "IPY_MODEL_56312e3c59ef42a0b8c1b00314d2c88e", "IPY_MODEL_b14936c3673445ef809fe18d38562794"], "layout": "IPY_MODEL_642bb1a56059491aa5a6be982064f291", "tabbable": null, "tooltip": null}}, "1ce269d8fc9c4a04aade5f45ecd120f5": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "52b8549f18be452887e38d799715f7b3": {"model_name": "ProgressStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ProgressStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "bar_color": null, "description_width": ""}}, "d7e0763bba4c4cde83b60efa35af1fc3": {"model_name": "FloatProgressModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "FloatProgressModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "ProgressView", "bar_style": "success", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_1ce269d8fc9c4a04aade5f45ecd120f5", "max": 250.0, "min": 0.0, "orientation": "horizontal", "style": "IPY_MODEL_52b8549f18be452887e38d799715f7b3", "tabbable": null, "tooltip": null, "value": 250.0}}, "cb47cd915a3d406fa142ee90f21aee3a": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "0f130d66a4a340d1a00dc5810f701aed": {"model_name": "HTMLStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "52734d42aa154bf78ac5350d600badb6": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_cb47cd915a3d406fa142ee90f21aee3a", "placeholder": "\u200b", "style": "IPY_MODEL_0f130d66a4a340d1a00dc5810f701aed", "tabbable": null, "tooltip": null, "value": "Applying\u2007wavelength\u2007calibration:\u2007100%"}}, "f70bfa8423cf431cbfff70a86a33abc9": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "dc43bc09ff804d44a1deb27b8920162f": {"model_name": "HTMLStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "8d133228d4d444f18b969f60d512d9de": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_f70bfa8423cf431cbfff70a86a33abc9", "placeholder": "\u200b", "style": "IPY_MODEL_dc43bc09ff804d44a1deb27b8920162f", "tabbable": null, "tooltip": null, "value": "\u2007250/250\u2007[00:00&lt;00:00,\u200712859.49it/s]"}}, "c224ff3ad171443ba064f21af2a753a0": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "3bfd83c45df2477db3df2fdb3b0d542d": {"model_name": "HBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_52734d42aa154bf78ac5350d600badb6", "IPY_MODEL_d7e0763bba4c4cde83b60efa35af1fc3", "IPY_MODEL_8d133228d4d444f18b969f60d512d9de"], "layout": "IPY_MODEL_c224ff3ad171443ba064f21af2a753a0", "tabbable": null, "tooltip": null}}, "74d1dc669bbf4dcbac5c787ad11efc7c": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "cf57b3434cb345f09c77733bd4cf2e77": {"model_name": "ProgressStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ProgressStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "bar_color": null, "description_width": ""}}, "71b3119d509a4d4fbedf69c4e0b3f995": {"model_name": "FloatProgressModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "FloatProgressModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "ProgressView", "bar_style": "success", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_74d1dc669bbf4dcbac5c787ad11efc7c", "max": 250.0, "min": 0.0, "orientation": "horizontal", "style": "IPY_MODEL_cf57b3434cb345f09c77733bd4cf2e77", "tabbable": null, "tooltip": null, "value": 250.0}}, "7be5dcc06f8140bba212eea64cb41bb2": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "4edd615871d4439492adb5e89e0e33fb": {"model_name": "HTMLStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "d956b98963f04feda6577b34363d56c5": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_7be5dcc06f8140bba212eea64cb41bb2", "placeholder": "\u200b", "style": "IPY_MODEL_4edd615871d4439492adb5e89e0e33fb", "tabbable": null, "tooltip": null, "value": "Applying\u2007wavelength\u2007calibration:\u2007100%"}}, "ee14cd860bcb42a29b53a65ca3fe2fb0": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "d1bd596282654b10adef12e268ef3d84": {"model_name": "HTMLStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "fef22ac4642a40cf857de54e759aca5d": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_ee14cd860bcb42a29b53a65ca3fe2fb0", "placeholder": "\u200b", "style": "IPY_MODEL_d1bd596282654b10adef12e268ef3d84", "tabbable": null, "tooltip": null, "value": "\u2007250/250\u2007[00:00&lt;00:00,\u200713491.19it/s]"}}, "395a4740442e4199b1e0417b16f9cf01": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "30989a0f5a9d4c4e96bb832ca61c1991": {"model_name": "HBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_d956b98963f04feda6577b34363d56c5", "IPY_MODEL_71b3119d509a4d4fbedf69c4e0b3f995", "IPY_MODEL_fef22ac4642a40cf857de54e759aca5d"], "layout": "IPY_MODEL_395a4740442e4199b1e0417b16f9cf01", "tabbable": null, "tooltip": null}}, "91e9fa1119f24751ad4ad00768dc0c6e": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "83a058fceee942769e156658433b63b6": {"model_name": "ProgressStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ProgressStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "bar_color": null, "description_width": ""}}, "4329daecbd774b93b178ac74720926f3": {"model_name": "FloatProgressModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "FloatProgressModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "ProgressView", "bar_style": "success", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_91e9fa1119f24751ad4ad00768dc0c6e", "max": 250.0, "min": 0.0, "orientation": "horizontal", "style": "IPY_MODEL_83a058fceee942769e156658433b63b6", "tabbable": null, "tooltip": null, "value": 250.0}}, "e84d14464fc74f4abcfe9ff2433d8962": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "0fd6b76b957943dc8efad15ec347b6ae": {"model_name": "HTMLStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "fa89fb5181624a58a00c261cecc896be": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_e84d14464fc74f4abcfe9ff2433d8962", "placeholder": "\u200b", "style": "IPY_MODEL_0fd6b76b957943dc8efad15ec347b6ae", "tabbable": null, "tooltip": null, "value": "Applying\u2007wavelength\u2007calibration:\u2007100%"}}, "0e53df24165448c693b597d23af0ce26": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "3052229f4ed744a7816c639bd251bd38": {"model_name": "HTMLStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "76031583dc564e918afcbae7a641ab36": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_0e53df24165448c693b597d23af0ce26", "placeholder": "\u200b", "style": "IPY_MODEL_3052229f4ed744a7816c639bd251bd38", "tabbable": null, "tooltip": null, "value": "\u2007250/250\u2007[00:00&lt;00:00,\u200713973.56it/s]"}}, "e3d7b483f29042d09ef3c4476e8513ca": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "107141b2703149b88c3f21d367ff4b46": {"model_name": "HBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_fa89fb5181624a58a00c261cecc896be", "IPY_MODEL_4329daecbd774b93b178ac74720926f3", "IPY_MODEL_76031583dc564e918afcbae7a641ab36"], "layout": "IPY_MODEL_e3d7b483f29042d09ef3c4476e8513ca", "tabbable": null, "tooltip": null}}, "a01f66212f8e4941a2ec6a20f2c0ce3e": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "a1a7401bc7684e37aa653600a3ef2182": {"model_name": "ProgressStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ProgressStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "bar_color": null, "description_width": ""}}, "4cc96953b0824033bda884e47839fb85": {"model_name": "FloatProgressModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "FloatProgressModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "ProgressView", "bar_style": "success", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_a01f66212f8e4941a2ec6a20f2c0ce3e", "max": 250.0, "min": 0.0, "orientation": "horizontal", "style": "IPY_MODEL_a1a7401bc7684e37aa653600a3ef2182", "tabbable": null, "tooltip": null, "value": 250.0}}, "b99a5ccc661a45af929af27cdb0534fd": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "0d0952d2ff024f248538720c0fc6fbd4": {"model_name": "HTMLStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "800693c4785d4750a95af56a1351fd38": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_b99a5ccc661a45af929af27cdb0534fd", "placeholder": "\u200b", "style": "IPY_MODEL_0d0952d2ff024f248538720c0fc6fbd4", "tabbable": null, "tooltip": null, "value": "Applying\u2007wavelength\u2007calibration:\u2007100%"}}, "98656b0828ff445e83667fb003c8e77c": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "5a00615b73924082a5f017bfe8290055": {"model_name": "HTMLStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "11f406d8cc2943e0a9f8fb4abcc2f9f0": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_98656b0828ff445e83667fb003c8e77c", "placeholder": "\u200b", "style": "IPY_MODEL_5a00615b73924082a5f017bfe8290055", "tabbable": null, "tooltip": null, "value": "\u2007250/250\u2007[00:00&lt;00:00,\u200713540.67it/s]"}}, "de6579b90d3641aaafdafa7f60aa2900": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "688c1ecca5ba4ef6ac60abd4417c998f": {"model_name": "HBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_800693c4785d4750a95af56a1351fd38", "IPY_MODEL_4cc96953b0824033bda884e47839fb85", "IPY_MODEL_11f406d8cc2943e0a9f8fb4abcc2f9f0"], "layout": "IPY_MODEL_de6579b90d3641aaafdafa7f60aa2900", "tabbable": null, "tooltip": null}}, "c277749ff270490b81885044bb73306f": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "24e8223dd4824a00833ba03021444b42": {"model_name": "ProgressStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ProgressStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "bar_color": null, "description_width": ""}}, "7d924017794c4b5fb0bca6d2fa94a36a": {"model_name": "FloatProgressModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "FloatProgressModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "ProgressView", "bar_style": "success", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_c277749ff270490b81885044bb73306f", "max": 250.0, "min": 0.0, "orientation": "horizontal", "style": "IPY_MODEL_24e8223dd4824a00833ba03021444b42", "tabbable": null, "tooltip": null, "value": 250.0}}, "d09acc3725e646e2a7408a081209c40d": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "56a31704e4f94127b470786687ab03a5": {"model_name": "HTMLStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "fd1601e0aa464feaa68d82d5cb4d14dd": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_d09acc3725e646e2a7408a081209c40d", "placeholder": "\u200b", "style": "IPY_MODEL_56a31704e4f94127b470786687ab03a5", "tabbable": null, "tooltip": null, "value": "Applying\u2007wavelength\u2007calibration:\u2007100%"}}, "2c4450cd2a3f42d583fd9bab776d5755": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "cd1e5514543d4772bd79dea9a553cdbf": {"model_name": "HTMLStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "2df42178a5b744e49c3dc023793bd639": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_2c4450cd2a3f42d583fd9bab776d5755", "placeholder": "\u200b", "style": "IPY_MODEL_cd1e5514543d4772bd79dea9a553cdbf", "tabbable": null, "tooltip": null, "value": "\u2007250/250\u2007[00:00&lt;00:00,\u200712911.59it/s]"}}, "bc9b420012634a9585feee6e68027c13": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "916fd44bfc48480d8a21c66bc91d25e9": {"model_name": "HBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_fd1601e0aa464feaa68d82d5cb4d14dd", "IPY_MODEL_7d924017794c4b5fb0bca6d2fa94a36a", "IPY_MODEL_2df42178a5b744e49c3dc023793bd639"], "layout": "IPY_MODEL_bc9b420012634a9585feee6e68027c13", "tabbable": null, "tooltip": null}}, "f4bd581f6a6442b691d8bfc68f4058aa": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "1fe679c214c34b42bf25cc35e909826d": {"model_name": "ProgressStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ProgressStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "bar_color": null, "description_width": ""}}, "c05ee77de7c845feae6937a2393aa017": {"model_name": "FloatProgressModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "FloatProgressModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "ProgressView", "bar_style": "success", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_f4bd581f6a6442b691d8bfc68f4058aa", "max": 250.0, "min": 0.0, "orientation": "horizontal", "style": "IPY_MODEL_1fe679c214c34b42bf25cc35e909826d", "tabbable": null, "tooltip": null, "value": 250.0}}, "bf0a0c18325443d7ab81a7cc6d7a1cf8": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "e8add236d2db4f2abdd3dca7bab2d74f": {"model_name": "HTMLStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "5eb7f86e11684d068c75b3f2f3ee4bb4": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_bf0a0c18325443d7ab81a7cc6d7a1cf8", "placeholder": "\u200b", "style": "IPY_MODEL_e8add236d2db4f2abdd3dca7bab2d74f", "tabbable": null, "tooltip": null, "value": "Applying\u2007wavelength\u2007calibration:\u2007100%"}}, "6b673233af934859a68849c9075d2d15": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "dd55ec6001ea469c98c968ad26687790": {"model_name": "HTMLStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "1bd34edae8a1492f8836e97c94231274": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_6b673233af934859a68849c9075d2d15", "placeholder": "\u200b", "style": "IPY_MODEL_dd55ec6001ea469c98c968ad26687790", "tabbable": null, "tooltip": null, "value": "\u2007250/250\u2007[00:00&lt;00:00,\u200713745.33it/s]"}}, "98fcb5f903ad476eb589b38bccc8993f": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "6b3d0ccabbdc45f6852653a1975edcbf": {"model_name": "HBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_5eb7f86e11684d068c75b3f2f3ee4bb4", "IPY_MODEL_c05ee77de7c845feae6937a2393aa017", "IPY_MODEL_1bd34edae8a1492f8836e97c94231274"], "layout": "IPY_MODEL_98fcb5f903ad476eb589b38bccc8993f", "tabbable": null, "tooltip": null}}}, "version_major": 2, "version_minor": 0}</script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script crossorigin="anonymous" data-jupyter-widgets-cdn="https://cdn.jsdelivr.net/npm/" src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@1.0.6/dist/embed-amd.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'notebooks/wavecalib/wavecalib';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Adaptive spline fit" href="../adaptivespl/adaptivespl.html" />
    <link rel="prev" title="Cosmic Ray Removal in Double Exposures" href="../cr2images/cr2images.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/logo.png" class="logo__image only-light" alt="Teareduce cookbook - Home"/>
    <script>document.write(`<img src="../../_static/logo.png" class="logo__image only-dark" alt="Teareduce cookbook - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    The package teareduce
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../aux.html">Auxiliary functions and classes</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../aux/imshow/imshow.html">The imshow wrapper</a></li>
<li class="toctree-l2"><a class="reference internal" href="../aux/sliceregion/sliceregion.html">Auxiliary classes for image slicing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../aux/elapsedtime/elapsedtime.html">Elapsed time and system information</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../simulateccd/simulateccd.html">Simulation of CCD images</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../docs/cleanest/cleanest.html">Interactive Cosmic Ray Removal in Single Exposures</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cr2images/cr2images.html">Cosmic Ray Removal in Double Exposures</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">C distortion and wavelength calibration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../adaptivespl/adaptivespl.html">Adaptive spline fit</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../bibliography.html">Bibliography</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/notebooks/wavecalib/wavecalib.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>C distortion and wavelength calibration</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#automatic-search-for-lines-of-interest-across-the-entire-image">Automatic search for lines of interest across the entire image.</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#wavelength-calibration-of-the-reference-spectrum">Wavelength Calibration of the Reference Spectrum</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#searching-for-the-lines-across-the-entire-image">Searching for the lines across the entire image</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fitting-the-c-distortion">Fitting the C distortion</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#partial-fits">Partial fits</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#wavelength-calibration-calculation-for-the-entire-image">Wavelength Calibration Calculation for the Entire Image</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reading-the-calibration-from-the-auxiliary-fits-file">Reading the Calibration from the Auxiliary FITS File</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#applying-the-wavelength-calibration">Applying the Wavelength Calibration</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#graphical-check">Graphical Check</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#numerical-check">Numerical Check</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#applying-the-calibration-to-a-ccddata-object">Applying the Calibration to a <code class="docutils literal notranslate"><span class="pre">CCDData</span></code> Object</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#auxiliary-function-apply-wavecal-ccddata">Auxiliary function <code class="docutils literal notranslate"><span class="pre">apply_wavecal_ccddata()</span></code></a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="c-distortion-and-wavelength-calibration">
<h1>C distortion and wavelength calibration<a class="headerlink" href="#c-distortion-and-wavelength-calibration" title="Link to this heading">#</a></h1>
<p>This notebook describes how to perform the C distortion correction and the wavelength calibration of an image following the strategy outlined below.</p>
<p><strong>Important</strong>: it is assumed that the data array is oriented such that the spectral direction corresponds to the horizontal axis and the spatial direction to the vertical axis. Additionally, it is assumed that the spectral scale increases from left to right.</p>
<p><em>Modus operandi</em>:</p>
<ol class="arabic simple">
<li><p>Identification of lines with known wavelengths: this is done on an average spectrum of the image.</p></li>
<li><p>Wavelength calibration of an initial spectrum: this helps determine the appropriate degree of the polynomial to be fitted.</p></li>
<li><p>Automatic search for the lines of interest across the entire image (it is possible to skip regions in the spatial direction if necessary).</p></li>
<li><p>C distortion fitting: the distortion of each line is fitted using a polynomial of the required degree.</p></li>
<li><p>Determination of the wavelength calibration polynomial for each spectrum. This calculation is based on the positions of the lines predicted by the polynomials that describe the C distortion of the image.</p></li>
<li><p>Storage of the wavelength calibration polynomials in an auxiliary FITS file.</p></li>
<li><p>Application of the wavelength calibration polynomials to perform, in a single step, both the C distortion correction and the wavelength calibration (i.e., transformation of the image to a linear wavelength scale).</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">astropy.io</span> <span class="kn">import</span> <span class="n">fits</span>
<span class="kn">from</span> <span class="nn">astropy.nddata</span> <span class="kn">import</span> <span class="n">CCDData</span>
<span class="kn">import</span> <span class="nn">astropy.units</span> <span class="k">as</span> <span class="nn">u</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">mpl_toolkits.axes_grid1</span> <span class="kn">import</span> <span class="n">make_axes_locatable</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="kn">import</span> <span class="nn">teareduce</span> <span class="k">as</span> <span class="nn">tea</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">time_ini</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">time_ini</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-10-27 16:50:56.067898
</pre></div>
</div>
</div>
</div>
<p>Download the required file</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tea</span><span class="o">.</span><span class="n">get_cookbook_file</span><span class="p">(</span><span class="s1">&#39;notebooks/wavecalib/ftdz_45324.fits&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>File ftdz_45324.fits downloaded!
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tea</span><span class="o">.</span><span class="n">avoid_astropy_warnings</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We will work with a specific image from Practice 3: <code class="docutils literal notranslate"><span class="pre">ftdz_45324.fits</span></code> (in this image we have already subtracted the BIAS and DARK, cropped the <em>under</em> and <em>overscan</em> regions, and applied the Flat Field).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">input_filename</span> <span class="o">=</span> <span class="s1">&#39;ftdz_45324.fits&#39;</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">getdata</span><span class="p">(</span><span class="n">input_filename</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We display the full image and a zoom around one of the lines, which allows us to observe that there is a certain C distortion.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">iplot</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">iplot</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">95</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">99</span><span class="p">])</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
    <span class="n">tea</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">input_filename</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
               <span class="n">aspect</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">iplot</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mi">74</span><span class="p">,</span> <span class="mi">83</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/b5d6b75b598372725fc1b78976c44f6a5bf573afa1bb0e30698b837a7ba244d8.png" src="../../_images/b5d6b75b598372725fc1b78976c44f6a5bf573afa1bb0e30698b837a7ba244d8.png" />
<img alt="../../_images/2a0545f6059a241731636a7b7f3d74cf0ae9bcb7523b2b255c9d19900f1d7dd3.png" src="../../_images/2a0545f6059a241731636a7b7f3d74cf0ae9bcb7523b2b255c9d19900f1d7dd3.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">naxis2</span><span class="p">,</span> <span class="n">naxis1</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;NAXIS1, NAXIS2: </span><span class="si">{</span><span class="n">naxis1</span><span class="si">}</span><span class="s1">, </span><span class="si">{</span><span class="n">naxis2</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>NAXIS1, NAXIS2: 1024, 250
</pre></div>
</div>
</div>
</div>
<section id="automatic-search-for-lines-of-interest-across-the-entire-image">
<h2>Automatic search for lines of interest across the entire image.<a class="headerlink" href="#automatic-search-for-lines-of-interest-across-the-entire-image" title="Link to this heading">#</a></h2>
<p>We create an instance of type <code class="docutils literal notranslate"><span class="pre">TeaWaveCalibration</span></code> which, by default, has predefined initial values to carry out the work of calibration and correction of C distortion and wavelength calibration. These initial parameters can be modified as we, through trial and error, find more suitable values for calibrating the image at hand.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wavecalib</span> <span class="o">=</span> <span class="n">tea</span><span class="o">.</span><span class="n">TeaWaveCalibration</span><span class="p">()</span>
<span class="n">wavecalib</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>TeaWaveCalibration(
    ns_window=11,
    threshold=0,
    sigma_smooth=0,
    nx_window=5,
    delta_flux=0,
    method=&#39;gaussian&#39;,
    degree_cdistortion=1,
    degree_wavecalib=1,
    peak_wavelengths=None,
    _nlines_reference=None,
    _naxis1=None,
    _naxis2=None,
    _xpeaks_all_lines_array=None,
    _valid_scans=None,
    _list_poly_cdistortion=None,
    _array_poly_wav=None,
    _array_poly_pix=None,
    _array_residual_std_wav=None,
    _array_residual_std_pix=None,
    _array_crval1_linear=None,
    _array_cdelt1_linear=None,
    _array_crmax1_linear=None
)
</pre></div>
</div>
</div>
</div>
<p>We can easily view the documentation of the class.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">tea</span><span class="o">.</span><span class="n">TeaWaveCalibration</span><span class="o">.</span><span class="vm">__doc__</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Auxiliary class to compute and apply wavelength calibration.

    It is assumed that the wavelength and spatial directions correspond
    to the X (array columns) and Y (array rows) axes, respectively.

    Attributes
    ----------
    ns_window : int
        Number of spectra to be (median) averaged. It must be odd.
    threshold : float
        Minimum signal to search for peaks.
    sigma_smooth : int
        Standard deviation for Gaussian kernel to smooth median spectrum.
        A value of 0 means that no smoothing is performed.
    nx_window : int
        Number of pixels (spectral direction) of the window where the
        peaks are sought. It must be odd.
    delta_flux : float
        Minimum difference between the flux at the line center and the
        flux at the borders of the window where the peaks are sought.
    method : str
        Function to be employed when fitting line peaks:
        - &quot;poly2&quot; : fit to a 2nd order polynomial
        - &quot;gaussian&quot; : fit to a Gaussian
    degree_cdistortion : int
        Polynomial degree to fit curvature of each arc line.
    degree_wavecalib : int
        Polynomial degree to fit wavelength variation with pixel number.
    peak_wavelengths : astropy.unit.Quantity or None
        Array providing the wavelengths of the line peaks, with units.

    
</pre></div>
</div>
</div>
</div>
<p>The first thing we need to do is obtain an approximate position of the line peaks. If there is significant C distortion, it is not advisable to combine many spectra, as this would broaden the lines. On the other hand, it is worth combining several spectra because this improves the signal-to-noise ratio and helps eliminate cosmic rays (if they haven’t already been removed). This is possible because the average spectrum we will work with is obtained using a median average (instead of a mean).</p>
<p>The default parameters we can adjust are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">ns_window</span></code>: number of spectra that can be collapsed to obtain an average spectrum in which to search for peaks.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">threshold</span></code>: minimum number of counts a peak must have to be considered as such.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sigma_smooth</span></code>: for noisy spectra, it is useful to convolve with a Gaussian filter. This parameter indicates the width of that kernel (see usage example below).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">nx_window</span></code>: each peak must meet the condition that the central value is the highest within a window of this width. Additionally, the pixels to the right and left of the peak must decrease monotonically. It must be an odd number so that there are <code class="docutils literal notranslate"><span class="pre">nx_window/2</span></code> pixels on each side of the central peak.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">delta_flux</span></code>: within each peak search window (of width <code class="docutils literal notranslate"><span class="pre">nx_window</span></code>), the signal at the peak must exceed the value at the pixels located at the edges of the interval by a minimum amount given by this <code class="docutils literal notranslate"><span class="pre">delta_flux</span></code> factor. By default, this value is zero. This parameter helps detect/ignore peaks when the arc to be calibrated has a variable continuum signal along the spectral direction, which makes it difficult to find a <code class="docutils literal notranslate"><span class="pre">threshold</span></code> value that works across the entire interval.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">method</span></code>: method used to refine the peak position. Only two options are available: <code class="docutils literal notranslate"><span class="pre">poly2</span></code> or <code class="docutils literal notranslate"><span class="pre">gaussian</span></code> (a parabola or a Gaussian).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">degree_cdistortion</span></code>: degree of the polynomial used to fit the C distortion of the lines.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">degree_wavecal</span></code>: degree of the polynomial used for wavelength calibration.</p></li>
</ul>
<div class="alert alert-block alert-warning">
    <b>Note:</b> several methods of the <font face="Courier">TeaWaveCalibration</font> class that generate plots have a parameter <font face="Courier">pdf_output='filename.pdf'</font> which allows generating a PDF file with those plots. In these cases, there is also another parameter <font face="Courier">pdf_only</font> which can be <font face="Courier">True</font> or <font face="Courier">False</font>, indicating whether or not to display the plots in the notebook in addition to saving the PDF file.
</div>
<p>In this example, we will collapse 11 spectra, starting from 120 and ending at 130 (following the FITS numbering convention, which starts at 1). To do this, we use the auxiliary class <code class="docutils literal notranslate"><span class="pre">SliceRegion1D</span></code>, which allows us to define an interval using either the FITS or Python convention.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ns_range</span> <span class="o">=</span> <span class="n">tea</span><span class="o">.</span><span class="n">SliceRegion1D</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">s_</span><span class="p">[</span><span class="mi">120</span><span class="p">:</span><span class="mi">130</span><span class="p">],</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;fits&#39;</span><span class="p">)</span>
<span class="n">ns_range_bis</span> <span class="o">=</span> <span class="n">tea</span><span class="o">.</span><span class="n">SliceRegion1D</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">s_</span><span class="p">[</span><span class="mi">119</span><span class="p">:</span><span class="mi">130</span><span class="p">],</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;python&#39;</span><span class="p">)</span>

<span class="c1"># check that both instances correspond to the same region</span>
<span class="n">ns_range</span> <span class="o">==</span> <span class="n">ns_range_bis</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<p>We use the method <code class="docutils literal notranslate"><span class="pre">compute_xpeaks_reference()</span></code>, which returns an array with the positions of the peaks (in <em>array coordinates</em>; that is, starting from 0), both in real format <code class="docutils literal notranslate"><span class="pre">xpeaks_reference</span></code> (the positions have been fitted to a Gaussian because <code class="docutils literal notranslate"><span class="pre">method='gaussian'</span></code> is set in the default parameters) and in integer format <code class="docutils literal notranslate"><span class="pre">ixpeaks_reference</span></code> (array indices). We also obtain the average spectrum used: <code class="docutils literal notranslate"><span class="pre">spectrum_reference</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xpeaks_reference</span><span class="p">,</span> <span class="n">ixpeaks_reference</span><span class="p">,</span> <span class="n">spectrum_reference</span> <span class="o">=</span> <span class="n">wavecalib</span><span class="o">.</span><span class="n">compute_xpeaks_reference</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
    <span class="n">ns_range</span><span class="o">=</span><span class="n">ns_range</span><span class="p">,</span>
    <span class="n">plot_spectrum</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="n">input_filename</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/68ae1921015121f4709c4840c1d192ff48192ebde55f8ad4cdfb039a3fc160bb.png" src="../../_images/68ae1921015121f4709c4840c1d192ff48192ebde55f8ad4cdfb039a3fc160bb.png" />
</div>
</div>
<p>Note that in the representation we are using a logarithmic scale on the vertical axis. In the case of arcs, this is very useful because we often encounter both bright and faint lines.</p>
<p>We have found too many peaks because the default <code class="docutils literal notranslate"><span class="pre">threshold</span></code> is zero.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xpeaks_reference</span><span class="p">,</span> <span class="n">ixpeaks_reference</span><span class="p">,</span> <span class="n">spectrum_reference</span> <span class="o">=</span> <span class="n">wavecalib</span><span class="o">.</span><span class="n">compute_xpeaks_reference</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
    <span class="n">ns_range</span><span class="o">=</span><span class="n">ns_range</span><span class="p">,</span>
    <span class="n">threshold</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
    <span class="n">plot_spectrum</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="n">input_filename</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/2e59e9dd27567c22b2af4f4fa269718a8a652895894ba0a23f0e455f87c5f6e8.png" src="../../_images/2e59e9dd27567c22b2af4f4fa269718a8a652895894ba0a23f0e455f87c5f6e8.png" />
</div>
</div>
<p>By having modified the <code class="docutils literal notranslate"><span class="pre">threshold</span></code> parameter, its value has changed in the <code class="docutils literal notranslate"><span class="pre">wavecalib</span></code> object’s attribute.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wavecalib</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>TeaWaveCalibration(
    ns_window=11,
    threshold=50,
    sigma_smooth=0,
    nx_window=5,
    delta_flux=0,
    method=&#39;gaussian&#39;,
    degree_cdistortion=1,
    degree_wavecalib=1,
    peak_wavelengths=None,
    _nlines_reference=None,
    _naxis1=1024,
    _naxis2=250,
    _xpeaks_all_lines_array=None,
    _valid_scans=None,
    _list_poly_cdistortion=None,
    _array_poly_wav=None,
    _array_poly_pix=None,
    _array_residual_std_wav=None,
    _array_residual_std_pix=None,
    _array_crval1_linear=None,
    _array_cdelt1_linear=None,
    _array_crmax1_linear=None
)
</pre></div>
</div>
</div>
</div>
<p>We display the individual fit to each of the peaks using the parameter <code class="docutils literal notranslate"><span class="pre">plot_peaks=True</span></code> (there’s no need to specify the <code class="docutils literal notranslate"><span class="pre">threshold</span></code> anymore because it will use the current default, which is already 50).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xpeaks_reference</span><span class="p">,</span> <span class="n">ixpeaks_reference</span><span class="p">,</span> <span class="n">spectrum_reference</span> <span class="o">=</span> <span class="n">wavecalib</span><span class="o">.</span><span class="n">compute_xpeaks_reference</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
    <span class="n">ns_range</span><span class="o">=</span><span class="n">ns_range</span><span class="p">,</span>
    <span class="n">plot_spectrum</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">plot_peaks</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="n">input_filename</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/f815ae6322633d6acece40897444025c85183322f6dfdd6c503039a1a4e9d354.png" src="../../_images/f815ae6322633d6acece40897444025c85183322f6dfdd6c503039a1a4e9d354.png" />
<img alt="../../_images/2e59e9dd27567c22b2af4f4fa269718a8a652895894ba0a23f0e455f87c5f6e8.png" src="../../_images/2e59e9dd27567c22b2af4f4fa269718a8a652895894ba0a23f0e455f87c5f6e8.png" />
</div>
</div>
<p>Some peaks found in the wings of bright lines are spurious. We can get rid of them by smoothing the spectrum (<code class="docutils literal notranslate"><span class="pre">sigma_smooth=2</span></code>; this parameter is updated in the <code class="docutils literal notranslate"><span class="pre">wavecalib</span></code> object and if we’re satisfied with it, there’s no need to specify it again).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xpeaks_reference</span><span class="p">,</span> <span class="n">ixpeaks_reference</span><span class="p">,</span> <span class="n">spectrum_reference</span> <span class="o">=</span> <span class="n">wavecalib</span><span class="o">.</span><span class="n">compute_xpeaks_reference</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
    <span class="n">ns_range</span><span class="o">=</span><span class="n">ns_range</span><span class="p">,</span>
    <span class="n">sigma_smooth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">plot_spectrum</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">plot_peaks</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="n">input_filename</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/3bc10c9026fe5a52a28b3926e11060af68acccbcb423fb27cfd40bead665b41a.png" src="../../_images/3bc10c9026fe5a52a28b3926e11060af68acccbcb423fb27cfd40bead665b41a.png" />
<img alt="../../_images/2717b61db5ffca66f9e756c65c9f241dacffa37df0cfdd0aea72f46861ccd9a2.png" src="../../_images/2717b61db5ffca66f9e756c65c9f241dacffa37df0cfdd0aea72f46861ccd9a2.png" />
</div>
</div>
<p>The latest values of the parameters we have modified have been stored.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wavecalib</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>TeaWaveCalibration(
    ns_window=11,
    threshold=50,
    sigma_smooth=2,
    nx_window=5,
    delta_flux=0,
    method=&#39;gaussian&#39;,
    degree_cdistortion=1,
    degree_wavecalib=1,
    peak_wavelengths=None,
    _nlines_reference=None,
    _naxis1=1024,
    _naxis2=250,
    _xpeaks_all_lines_array=None,
    _valid_scans=None,
    _list_poly_cdistortion=None,
    _array_poly_wav=None,
    _array_poly_pix=None,
    _array_residual_std_wav=None,
    _array_residual_std_pix=None,
    _array_crval1_linear=None,
    _array_cdelt1_linear=None,
    _array_crmax1_linear=None
)
</pre></div>
</div>
</div>
</div>
<p>The final positions of the lines (in <em>array coordinates</em>, starting from 0) are</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xpeaks_reference</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[[10.31063,~77.784043,~246.98259,~383.1147,~450.32838,~549.84018,~641.77591,~946.74695] \; \mathrm{pix}\]</div>
</div>
</div>
<p>Note that these positions <strong>are not stored as an attribute</strong> in the <code class="docutils literal notranslate"><span class="pre">wavecalib</span></code> object we created, but rather we have them stored in an external array that we can modify as we wish. The advantage of this approach is that we can easily remove some of the peaks. For example, we can remove:</p>
<ul class="simple">
<li><p>saturated lines</p></li>
<li><p>unreliable peaks from faint lines</p></li>
<li><p>peaks from lines whose wavelengths we do not know</p></li>
</ul>
<p>In our case, there’s no need to remove any peaks because the 8 we found are useful. But suppose we wanted to remove the third and fifth peaks (indices 2 and 4). We can remove them from the array using NumPy functionality.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xpeaks_reference_new</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">xpeaks_reference</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="n">xpeaks_reference_new</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[[10.31063,~77.784043,~383.1147,~549.84018,~641.77591,~946.74695] \; \mathrm{pix}\]</div>
</div>
</div>
<p>The above has not modified the original array.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xpeaks_reference</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[[10.31063,~77.784043,~246.98259,~383.1147,~450.32838,~549.84018,~641.77591,~946.74695] \; \mathrm{pix}\]</div>
</div>
</div>
</section>
<section id="wavelength-calibration-of-the-reference-spectrum">
<h2>Wavelength Calibration of the Reference Spectrum<a class="headerlink" href="#wavelength-calibration-of-the-reference-spectrum" title="Link to this heading">#</a></h2>
<p>We need to specify the wavelengths of the peaks we consider useful and for which we know the wavelengths. For this, we use the method <code class="docutils literal notranslate"><span class="pre">define_peak_wavelengths()</span></code>, which requires the wavelengths (in increasing order) of the peaks, <strong>with units</strong>. This function needs two arguments: the array with the detected peaks and the array of wavelengths (the first parameter is only used to check that the number of elements is the same in both arrays).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wavelengths_reference</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
    <span class="p">[</span>
        <span class="mf">6506.528</span><span class="p">,</span> <span class="mf">6532.880</span><span class="p">,</span> <span class="mf">6598.953</span><span class="p">,</span> 
        <span class="mf">6652.090</span><span class="p">,</span> <span class="mf">6678.200</span><span class="p">,</span> <span class="mf">6717.043</span><span class="p">,</span> 
        <span class="mf">6752.832</span><span class="p">,</span> <span class="mf">6871.290</span>
    <span class="p">]</span>
<span class="p">)</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">Angstrom</span>

<span class="n">wavecalib</span><span class="o">.</span><span class="n">define_peak_wavelengths</span><span class="p">(</span>
    <span class="n">xpeaks</span><span class="o">=</span><span class="n">xpeaks_reference</span><span class="p">,</span>
    <span class="n">wavelengths</span><span class="o">=</span> <span class="n">wavelengths_reference</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The wavelengths entered are stored in the <code class="docutils literal notranslate"><span class="pre">peak_wavelengths</span></code> attribute.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wavecalib</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>TeaWaveCalibration(
    ns_window=11,
    threshold=50,
    sigma_smooth=2,
    nx_window=5,
    delta_flux=0,
    method=&#39;gaussian&#39;,
    degree_cdistortion=1,
    degree_wavecalib=1,
    peak_wavelengths=&lt;Quantity [6506.528, 6532.88 , 6598.953, 6652.09 , 6678.2  , 6717.043,
           6752.832, 6871.29 ] Angstrom&gt;,
    _nlines_reference=None,
    _naxis1=1024,
    _naxis2=250,
    _xpeaks_all_lines_array=None,
    _valid_scans=None,
    _list_poly_cdistortion=None,
    _array_poly_wav=None,
    _array_poly_pix=None,
    _array_residual_std_wav=None,
    _array_residual_std_pix=None,
    _array_crval1_linear=None,
    _array_cdelt1_linear=None,
    _array_crmax1_linear=None
)
</pre></div>
</div>
</div>
</div>
<p>We can display the spectrum with the introduced wavelengths (we also save the plot in a PDF file).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wavecalib</span><span class="o">.</span><span class="n">overplot_identified_lines</span><span class="p">(</span>
    <span class="n">xpeaks</span><span class="o">=</span><span class="n">xpeaks_reference</span><span class="p">,</span>
    <span class="n">spectrum</span><span class="o">=</span><span class="n">spectrum_reference</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Identified arc lines in </span><span class="si">{</span><span class="n">input_filename</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span>
          <span class="sa">f</span><span class="s1">&#39;(median spectrum from scans </span><span class="si">{</span><span class="n">ns_range</span><span class="o">.</span><span class="n">fits</span><span class="o">.</span><span class="n">start</span><span class="si">}</span><span class="s1"> to </span><span class="si">{</span><span class="n">ns_range</span><span class="o">.</span><span class="n">fits</span><span class="o">.</span><span class="n">stop</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">,</span>
    <span class="n">pdf_output</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;plot_</span><span class="si">{</span><span class="n">Path</span><span class="p">(</span><span class="n">input_filename</span><span class="p">)</span><span class="o">.</span><span class="n">stem</span><span class="si">}</span><span class="s1">_identified_lines.pdf&#39;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>--&gt; Saving PDF file: plot_ftdz_45324_identified_lines.pdf
</pre></div>
</div>
<img alt="../../_images/9d87705ca77431b82d23990b29fa84cdc30982444e7733d84d3d306940bbdd54.png" src="../../_images/9d87705ca77431b82d23990b29fa84cdc30982444e7733d84d3d306940bbdd54.png" />
</div>
</div>
<p>Now we can proceed with the calculation of the wavelength calibration polynomial. We do this using the <code class="docutils literal notranslate"><span class="pre">fit_xpeaks_wavelengths()</span></code> method, which requires the array with the peak positions as an argument. In this case, we also enable it to display additional information on screen (<code class="docutils literal notranslate"><span class="pre">debug=True</span></code>) and force it to graphically show the result (<code class="docutils literal notranslate"><span class="pre">plots=True</span></code>).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">poly_fits_wav</span><span class="p">,</span> <span class="n">residual_std_wav</span><span class="p">,</span> <span class="n">poly_fits_pix</span><span class="p">,</span> <span class="n">residual_std_pix</span><span class="p">,</span> \
<span class="n">crval1_linear</span><span class="p">,</span> <span class="n">cdelt1_linear</span><span class="p">,</span> <span class="n">crmax1_linear</span> <span class="o">=</span> <span class="n">wavecalib</span><span class="o">.</span><span class="n">fit_xpeaks_wavelengths</span><span class="p">(</span>
    <span class="n">xpeaks</span><span class="o">=</span><span class="n">xpeaks_reference</span><span class="p">,</span> 
    <span class="n">debug</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">plots</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="n">input_filename</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&gt;&gt;&gt; CRPIX1.............: 1.0 pix
&gt;&gt;&gt; CRVAL1 linear scale: 6502.675086411518 Angstrom
&gt;&gt;&gt; CDELT1 linear scale: 0.38961619272091536 Angstrom / pix
&gt;&gt;&gt; CRMAX1 linear scale: 6901.252451565015 Angstrom

&gt;&gt;&gt; Fitted coefficients pixel(wavelength):
 [-1.66889508e+04  2.56662844e+00]
&gt;&gt;&gt; Residual std.........................: 0.4222488109411236 pix

&gt;&gt;&gt; Fitted coefficients wavelength(pixel):
 [6.50228547e+03 3.89616193e-01]
&gt;&gt;&gt; Residual std.........................: 0.16451497409981417 Angstrom
</pre></div>
</div>
<img alt="../../_images/498605c22e565ed0bbcd6f64efc81481d04f6f5dbee38747f4a6c625143b3d37.png" src="../../_images/498605c22e565ed0bbcd6f64efc81481d04f6f5dbee38747f4a6c625143b3d37.png" />
</div>
</div>
<p>By default, it has used a polynomial of degree <code class="docutils literal notranslate"><span class="pre">degree_wavecalib=1</span></code>. We are going to increase it to a polynomial of degree 3. Since this fit will be valid, we also save the plots in a PDF file.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">poly_fits_wav</span><span class="p">,</span> <span class="n">residual_std_wav</span><span class="p">,</span> <span class="n">poly_fits_pix</span><span class="p">,</span> <span class="n">residual_std_pix</span><span class="p">,</span> \
<span class="n">crval1_linear</span><span class="p">,</span> <span class="n">cdelt1_linear</span><span class="p">,</span> <span class="n">crmax1_linear</span> <span class="o">=</span> <span class="n">wavecalib</span><span class="o">.</span><span class="n">fit_xpeaks_wavelengths</span><span class="p">(</span>
    <span class="n">xpeaks</span><span class="o">=</span><span class="n">xpeaks_reference</span><span class="p">,</span>
    <span class="n">degree_wavecalib</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
    <span class="n">debug</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">plots</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="n">input_filename</span><span class="p">,</span>
    <span class="n">pdf_output</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;plot_</span><span class="si">{</span><span class="n">Path</span><span class="p">(</span><span class="n">input_filename</span><span class="p">)</span><span class="o">.</span><span class="n">stem</span><span class="si">}</span><span class="s1">_wavecalib.pdf&#39;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&gt;&gt;&gt; CRPIX1.............: 1.0 pix
&gt;&gt;&gt; CRVAL1 linear scale: 6502.500046514581 Angstrom
&gt;&gt;&gt; CDELT1 linear scale: 0.38938661758667775 Angstrom / pix
&gt;&gt;&gt; CRMAX1 linear scale: 6900.842556305753 Angstrom

&gt;&gt;&gt; Fitted coefficients pixel(wavelength):
 [-2.54126929e+04  6.65567621e+00 -6.37642087e-04  3.30842991e-08]
&gt;&gt;&gt; Residual std.........................: 0.09176281215627195 pix

&gt;&gt;&gt; Fitted coefficients wavelength(pixel):
 [ 6.50210939e+03  3.90659576e-01 -4.74427072e-07 -7.49495201e-10]
&gt;&gt;&gt; Residual std.........................: 0.03573121104577241 Angstrom
--&gt; Saving PDF file: plot_ftdz_45324_wavecalib.pdf
</pre></div>
</div>
<img alt="../../_images/8eb0805d6b5a3e9b5cc35095157b2f8adb819ad59422aefff67a64ad208e1b5d.png" src="../../_images/8eb0805d6b5a3e9b5cc35095157b2f8adb819ad59422aefff67a64ad208e1b5d.png" />
</div>
</div>
<p>The function first performs a fit to a polynomial of the form <code class="docutils literal notranslate"><span class="pre">pixel(wavelength)</span></code> (using <code class="docutils literal notranslate"><span class="pre">wavelength</span></code> as the independent variable and <code class="docutils literal notranslate"><span class="pre">pixel</span></code> as the dependent variable). We do it this way because we expect to have more uncertainty in the peak positions (determined by fitting the line profiles) than in the wavelengths of the lines (which are supposedly tabulated and known with high precision). This initial fit is then inverted to obtain a polynomial that provides <code class="docutils literal notranslate"><span class="pre">wavelength(pixel)</span></code>, which is more convenient for predicting the wavelength of any pixel. The function has returned the following parameters:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">poly_fits_wav</span></code>: corresponds to the polynomial <code class="docutils literal notranslate"><span class="pre">wavelength(pixel)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">residual_std_wav</span></code>: residual standard deviation corresponding to the previous fit (in wavelength units)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">poly_fits_pix</span></code>: corresponds to the polynomial <code class="docutils literal notranslate"><span class="pre">pixel(wavelength)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">residual_std_pix</span></code>: residual standard deviation corresponding to the previous fit (in pixels)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">crval1_linear</span></code>: value of CRVAL1 (wavelength of the first pixel) in the linear fit approximation</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cdelt1_linear</span></code>: value of CDELT1 (reciprocal linear dispersion; in this case in Angstrom/pixel)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">crmax1_linear</span></code>: this parameter is not a standard FITS keyword, but it is useful. It indicates the wavelength at the center of the pixel corresponding to NAXIS1.</p></li>
</ul>
<p>The last value of <code class="docutils literal notranslate"><span class="pre">degree_wavecal</span></code> has been stored in the <code class="docutils literal notranslate"><span class="pre">wavecalib</span></code> object, so it will be the value used (unless we decide to change it again).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wavecalib</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>TeaWaveCalibration(
    ns_window=11,
    threshold=50,
    sigma_smooth=2,
    nx_window=5,
    delta_flux=0,
    method=&#39;gaussian&#39;,
    degree_cdistortion=1,
    degree_wavecalib=3,
    peak_wavelengths=&lt;Quantity [6506.528, 6532.88 , 6598.953, 6652.09 , 6678.2  , 6717.043,
           6752.832, 6871.29 ] Angstrom&gt;,
    _nlines_reference=None,
    _naxis1=1024,
    _naxis2=250,
    _xpeaks_all_lines_array=None,
    _valid_scans=None,
    _list_poly_cdistortion=None,
    _array_poly_wav=None,
    _array_poly_pix=None,
    _array_residual_std_wav=None,
    _array_residual_std_pix=None,
    _array_crval1_linear=None,
    _array_cdelt1_linear=None,
    _array_crmax1_linear=None
)
</pre></div>
</div>
</div>
</div>
</section>
<section id="searching-for-the-lines-across-the-entire-image">
<h2>Searching for the lines across the entire image<a class="headerlink" href="#searching-for-the-lines-across-the-entire-image" title="Link to this heading">#</a></h2>
<p>If the C distortion of the image is not too severe, it is likely that we can fit the position of all selected peaks using an automatic procedure that only requires the initial position of the peaks.</p>
<p>We run this procedure using the <code class="docutils literal notranslate"><span class="pre">compute_xpeaks_image()</span></code> method, to which we must pass the 2D image array <code class="docutils literal notranslate"><span class="pre">data</span></code> and the peak positions <code class="docutils literal notranslate"><span class="pre">xpeaks_reference</span></code> for which we know the associated wavelengths. This function can also graphically display all the peaks found for each spectrum and the association of those peaks to each particular line (<code class="docutils literal notranslate"><span class="pre">plots=True</span></code>). The parameter <code class="docutils literal notranslate"><span class="pre">disable_tqdm=False</span></code> indicates that we want to see a progress bar in the notebook as the calculations are performed.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wavecalib</span><span class="o">.</span><span class="n">compute_xpeaks_image</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> 
    <span class="n">xpeaks_reference</span><span class="o">=</span><span class="n">xpeaks_reference</span><span class="p">,</span> 
    <span class="n">plots</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">disable_tqdm</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="n">input_filename</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "0c88bf3f42404262998c7fbceaecbc7f"}</script><img alt="../../_images/fdd96ea6da59f71187acb64b593b842f60ae4406bf370e88ad85b9763ccfebd8.png" src="../../_images/fdd96ea6da59f71187acb64b593b842f60ae4406bf370e88ad85b9763ccfebd8.png" />
</div>
</div>
<p>In green, we see peaks found in the different spectra. The function selects, for each line, the peak closest to the average (median) position of the peaks in the <code class="docutils literal notranslate"><span class="pre">ns_window</span></code> nearest spectra (in this case, we are using the default value <code class="docutils literal notranslate"><span class="pre">ns_window=11</span></code>). This ensures that the predicted position for the peaks in each new spectrum follows the C distortion calculated from neighboring spectra. Since we haven’t specified a particular spectral region, the procedure starts with the first spectrum (at the bottom) and progresses up to the spectrum corresponding to NAXIS2 (this is also graphically indicated by the colored triangles shown over the starting spectrum). It is therefore advisable that the peaks in the first spectra are relatively close to the position indicated in <code class="docutils literal notranslate"><span class="pre">xpeaks_reference</span></code>. The peaks of each line are marked in red (odd lines) and purple (even lines). For cases where the C distortion is significant, it is possible to use a more elaborate method that allows fitting different intervals along the spectral direction (see example below).</p>
<p>In the example we are considering, the automatic method works perfectly.</p>
</section>
<section id="fitting-the-c-distortion">
<h2>Fitting the C distortion<a class="headerlink" href="#fitting-the-c-distortion" title="Link to this heading">#</a></h2>
<p>We can now proceed with fitting the C distortion for each line. By default, a polynomial of degree 1 is used.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wavecalib</span><span class="o">.</span><span class="n">fit_cdistortion</span><span class="p">(</span>
    <span class="n">plots</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="n">input_filename</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/bd767af8c55bced61b37dfaf758483b3961d72b57d387155f98b8c7c637eac4c.png" src="../../_images/bd767af8c55bced61b37dfaf758483b3961d72b57d387155f98b8c7c637eac4c.png" />
</div>
</div>
<p>The lines show curvature, and a polynomial of degree 1 is not sufficient. We increase the degree of the polynomial to fit the C distortion using <code class="docutils literal notranslate"><span class="pre">degree_cdistortion=2</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wavecalib</span><span class="o">.</span><span class="n">fit_cdistortion</span><span class="p">(</span>
    <span class="n">degree_cdistortion</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> 
    <span class="n">plots</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="n">input_filename</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/9849ac4d84e49fbccd1216eb5914c450e92e45c6e73c7ca4c0c2e146ecf81d22.png" src="../../_images/9849ac4d84e49fbccd1216eb5914c450e92e45c6e73c7ca4c0c2e146ecf81d22.png" />
</div>
</div>
<p>The result is now clearly better. The fit is performed iteratively by removing points that deviate more than 3 times the standard deviation (the <em>outliers</em> are shown in red). The last value of <code class="docutils literal notranslate"><span class="pre">degree_cdistortion</span></code> is stored as an attribute of the <code class="docutils literal notranslate"><span class="pre">wavecalib</span></code> object, so we don’t need to specify it again explicitly. New attributes have been updated in this object to store the selected peaks in each spectrum, as well as the polynomials fitted to the C distortion of each line.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wavecalib</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>TeaWaveCalibration(
    ns_window=11,
    threshold=50,
    sigma_smooth=2,
    nx_window=5,
    delta_flux=0,
    method=&#39;gaussian&#39;,
    degree_cdistortion=2,
    degree_wavecalib=3,
    peak_wavelengths=&lt;Quantity [6506.528, 6532.88 , 6598.953, 6652.09 , 6678.2  , 6717.043,
           6752.832, 6871.29 ] Angstrom&gt;,
    _nlines_reference=8,
    _naxis1=1024,
    _naxis2=250,
    _xpeaks_all_lines_array=array([[ 10.32905234,  77.80555129, 247.02193551, ..., 549.89121403,
        641.77328117, 946.83276802],
       [ 10.33260378,  77.81100587, 247.01588494, ..., 549.89207883,
        641.76059442, 946.82642287],
       [ 10.34568947,  77.81000046, 247.02368721, ..., 549.88797079,
        641.79459232, 946.80807042],
       ...,
       [ 10.87332486,  78.33716115, 247.54521942, ..., 550.4003933 ,
        642.31360776, 947.30193393],
       [ 10.87840224,  78.34162022, 247.54803766, ..., 550.40171927,
        642.33887363, 947.261077  ],
       [ 10.88042931,  78.34612774, 247.55216   , ..., 550.40582838,
        642.36933702, 947.36151689]], shape=(250, 8)),
    _valid_scans=array([ True,  True,  True,  True,  True,  True,  True,  True,  True,
        True,  True,  True,  True,  True,  True,  True,  True,  True,
        True,  True,  True,  True,  True,  True,  True,  True,  True,
        True,  True,  True,  True,  True,  True,  True,  True,  True,
        True,  True,  True,  True,  True,  True,  True,  True,  True,
        True,  True,  True,  True,  True,  True,  True,  True,  True,
        True,  True,  True,  True,  True,  True,  True,  True,  True,
        True,  True,  True,  True,  True,  True,  True,  True,  True,
        True,  True,  True,  True,  True,  True,  True,  True,  True,
        True,  True,  True,  True,  True,  True,  True,  True,  True,
        True,  True,  True,  True,  True,  True,  True,  True,  True,
        True,  True,  True,  True,  True,  True,  True,  True,  True,
        True,  True,  True,  True,  True,  True,  True,  True,  True,
        True,  True,  True,  True,  True,  True,  True,  True,  True,
        True,  True,  True,  True,  True,  True,  True,  True,  True,
        True,  True,  True,  True,  True,  True,  True,  True,  True,
        True,  True,  True,  True,  True,  True,  True,  True,  True,
        True,  True,  True,  True,  True,  True,  True,  True,  True,
        True,  True,  True,  True,  True,  True,  True,  True,  True,
        True,  True,  True,  True,  True,  True,  True,  True,  True,
        True,  True,  True,  True,  True,  True,  True,  True,  True,
        True,  True,  True,  True,  True,  True,  True,  True,  True,
        True,  True,  True,  True,  True,  True,  True,  True,  True,
        True,  True,  True,  True,  True,  True,  True,  True,  True,
        True,  True,  True,  True,  True,  True,  True,  True,  True,
        True,  True,  True,  True,  True,  True,  True,  True,  True,
        True,  True,  True,  True,  True,  True,  True,  True,  True,
        True,  True,  True,  True,  True,  True,  True]),
    _list_poly_cdistortion=[Polynomial([ 1.04334756e+01, -3.43444345e-03,  2.11570051e-05], domain=[-1.,  1.], window=[-1.,  1.], symbol=&#39;x&#39;), Polynomial([ 7.79139467e+01, -3.44029154e-03,  2.07424667e-05], domain=[-1.,  1.], window=[-1.,  1.], symbol=&#39;x&#39;), Polynomial([ 2.47129311e+02, -3.69188047e-03,  2.16317679e-05], domain=[-1.,  1.], window=[-1.,  1.], symbol=&#39;x&#39;), Polynomial([ 3.83306360e+02, -3.82106978e-03,  2.21481209e-05], domain=[-1.,  1.], window=[-1.,  1.], symbol=&#39;x&#39;), Polynomial([ 4.50475429e+02, -3.71155824e-03,  2.19920696e-05], domain=[-1.,  1.], window=[-1.,  1.], symbol=&#39;x&#39;), Polynomial([ 5.49998907e+02, -3.85060381e-03,  2.21252317e-05], domain=[-1.,  1.], window=[-1.,  1.], symbol=&#39;x&#39;), Polynomial([ 6.41946418e+02, -3.85681639e-03,  2.18820614e-05], domain=[-1.,  1.], window=[-1.,  1.], symbol=&#39;x&#39;), Polynomial([ 9.46940466e+02, -4.50828822e-03,  2.43954520e-05], domain=[-1.,  1.], window=[-1.,  1.], symbol=&#39;x&#39;)],
    _array_poly_wav=None,
    _array_poly_pix=None,
    _array_residual_std_wav=None,
    _array_residual_std_pix=None,
    _array_crval1_linear=None,
    _array_cdelt1_linear=None,
    _array_crmax1_linear=None
)
</pre></div>
</div>
</div>
</div>
<p>Finally, it is also useful to display the calculated C distortion over the original image, zooming in on each line.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wavecalib</span><span class="o">.</span><span class="n">plot_cdistortion</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">input_filename</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/a973545e6b78c184931091b2880c93ca75963cedcf1911ed585966a330a01dcc.png" src="../../_images/a973545e6b78c184931091b2880c93ca75963cedcf1911ed585966a330a01dcc.png" />
</div>
</div>
<section id="partial-fits">
<h3>Partial fits<a class="headerlink" href="#partial-fits" title="Link to this heading">#</a></h3>
<p>In particular cases where we need to ignore some spectra during the fitting, we can use a more refined procedure, which can also help us use sky lines (instead of arc lines) to perform the wavelength calibration (in this case, it may be essential to skip object spectra that interfere with the peak detection process).</p>
<p>Since we are continuing with the same example image, we delete the previously fitted C distortion polynomials but preserve the parameters we have identified as suitable for this image (<code class="docutils literal notranslate"><span class="pre">ns_window</span></code>, <code class="docutils literal notranslate"><span class="pre">threshold</span></code>, <code class="docutils literal notranslate"><span class="pre">sigma_smooth</span></code>, <code class="docutils literal notranslate"><span class="pre">nx_window</span></code>, <code class="docutils literal notranslate"><span class="pre">method</span></code>, <code class="docutils literal notranslate"><span class="pre">degree_cdistortion</span></code>, <code class="docutils literal notranslate"><span class="pre">degree_wavecal</span></code>, <code class="docutils literal notranslate"><span class="pre">peak_wavelengths</span></code>).</p>
<p>We achieve this using the <code class="docutils literal notranslate"><span class="pre">reset_image()</span></code> method.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wavecalib</span><span class="o">.</span><span class="n">reset_image</span><span class="p">()</span>
<span class="n">wavecalib</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>TeaWaveCalibration(
    ns_window=11,
    threshold=50,
    sigma_smooth=2,
    nx_window=5,
    delta_flux=0,
    method=&#39;gaussian&#39;,
    degree_cdistortion=2,
    degree_wavecalib=3,
    peak_wavelengths=&lt;Quantity [6506.528, 6532.88 , 6598.953, 6652.09 , 6678.2  , 6717.043,
           6752.832, 6871.29 ] Angstrom&gt;,
    _nlines_reference=None,
    _naxis1=None,
    _naxis2=None,
    _xpeaks_all_lines_array=None,
    _valid_scans=None,
    _list_poly_cdistortion=None,
    _array_poly_wav=None,
    _array_poly_pix=None,
    _array_residual_std_wav=None,
    _array_residual_std_pix=None,
    _array_crval1_linear=None,
    _array_cdelt1_linear=None,
    _array_crmax1_linear=None
)
</pre></div>
</div>
</div>
</div>
<p>As the C distortion in this image is not very large, the peak positions stored in <code class="docutils literal notranslate"><span class="pre">xpeaks_reference</span></code> are a good starting point for peak searching in any spectrum of the image.</p>
<p>We now proceed to calculate the C distortion, skipping the spectra in the intervals [81, 119] and [181, 199]. In other words, we fit the spectra corresponding to the intervals [1, 80], [120, 180], and [200, 250] (the numbers follow the FITS convention, which starts at 1; however, the plots show the <em>array index</em>, which starts at 0).</p>
<p>We begin by fitting the interval [1, 80].</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ns_range1</span> <span class="o">=</span> <span class="n">tea</span><span class="o">.</span><span class="n">SliceRegion1D</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">s_</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">80</span><span class="p">],</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;fits&#39;</span><span class="p">)</span>

<span class="n">wavecalib</span><span class="o">.</span><span class="n">compute_xpeaks_image</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
    <span class="n">xpeaks_reference</span><span class="o">=</span><span class="n">xpeaks_reference</span><span class="p">,</span>
    <span class="n">ns_range</span><span class="o">=</span><span class="n">ns_range1</span><span class="p">,</span>
    <span class="n">plots</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="n">input_filename</span><span class="p">,</span>
    <span class="n">disable_tqdm</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "db1d668b13e54c048482cfd05daae867"}</script><img alt="../../_images/b61664d292a5da8b999a881a3252a9fd5c22d32d7d3d5a2835893c1032a6978d.png" src="../../_images/b61664d292a5da8b999a881a3252a9fd5c22d32d7d3d5a2835893c1032a6978d.png" />
</div>
</div>
<p>The peaks of each line are marked in red (odd lines) and purple (even lines).</p>
<p>We continue with the interval [120, 180]. In this case, we will perform the peak search from top to bottom (that is, starting from spectrum 180 and going down to 120). This option (which in this example is not relevant) can be useful when we have images with strong C distortion and when the <code class="docutils literal notranslate"><span class="pre">xpeaks_reference</span></code> positions have been calculated for an average spectrum from the top part of the image. To indicate that we want to move from top to bottom in the peak search, we use the parameter <code class="docutils literal notranslate"><span class="pre">direction='down'</span></code>; this parameter, by default, is <code class="docutils literal notranslate"><span class="pre">'up'</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ns_range2</span> <span class="o">=</span> <span class="n">tea</span><span class="o">.</span><span class="n">SliceRegion1D</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">s_</span><span class="p">[</span><span class="mi">120</span><span class="p">:</span><span class="mi">180</span><span class="p">],</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;fits&#39;</span><span class="p">)</span>

<span class="n">wavecalib</span><span class="o">.</span><span class="n">compute_xpeaks_image</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
    <span class="n">xpeaks_reference</span><span class="o">=</span><span class="n">xpeaks_reference</span><span class="p">,</span>
    <span class="n">ns_range</span><span class="o">=</span><span class="n">ns_range2</span><span class="p">,</span>
    <span class="n">direction</span><span class="o">=</span><span class="s1">&#39;down&#39;</span><span class="p">,</span>
    <span class="n">plots</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="n">input_filename</span><span class="p">,</span>
    <span class="n">disable_tqdm</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "280206c740364f76bb88bc68e96e99fb"}</script><img alt="../../_images/598437a7131106c9ddb6f635fe41af8109df5d3cc1096df96d053f75593c74ff.png" src="../../_images/598437a7131106c9ddb6f635fe41af8109df5d3cc1096df96d053f75593c74ff.png" />
</div>
</div>
<p>The new peaks of each line are marked in red (odd lines) and purple (even lines), while the previously calculated peaks appear in blue (odd lines) and cyan (even lines). Note that it is graphically indicated that the peak search has been performed from top to bottom.</p>
<p>We add the peaks in a third interval [200, 250].</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ns_range3</span> <span class="o">=</span> <span class="n">tea</span><span class="o">.</span><span class="n">SliceRegion1D</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">s_</span><span class="p">[</span><span class="mi">200</span><span class="p">:</span><span class="mi">250</span><span class="p">],</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;fits&#39;</span><span class="p">)</span>

<span class="n">wavecalib</span><span class="o">.</span><span class="n">compute_xpeaks_image</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
    <span class="n">xpeaks_reference</span><span class="o">=</span><span class="n">xpeaks_reference</span><span class="p">,</span>
    <span class="n">ns_range</span><span class="o">=</span><span class="n">ns_range3</span><span class="p">,</span>
    <span class="n">plots</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="n">input_filename</span><span class="p">,</span>
    <span class="n">disable_tqdm</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "6997e114aff84bc085e51c4cf698d6dd"}</script><img alt="../../_images/808bc4eb5b706cc5851829e30bfe22b0712c809f0560477e8f702a953eb0c16f.png" src="../../_images/808bc4eb5b706cc5851829e30bfe22b0712c809f0560477e8f702a953eb0c16f.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wavecalib</span><span class="o">.</span><span class="n">fit_cdistortion</span><span class="p">(</span><span class="n">plots</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">input_filename</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/57d1de162b84028f9a29b5d6b3d06a07c697071007b26018d177de876c170acc.png" src="../../_images/57d1de162b84028f9a29b5d6b3d06a07c697071007b26018d177de876c170acc.png" />
</div>
</div>
<p>We can display the calculated C distortion over the original image by zooming in on each line.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wavecalib</span><span class="o">.</span><span class="n">plot_cdistortion</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">input_filename</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/515f3719099b439d0f608b8612ed514a536dd60ca5be6962730ea48821437640.png" src="../../_images/515f3719099b439d0f608b8612ed514a536dd60ca5be6962730ea48821437640.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wavecalib</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>TeaWaveCalibration(
    ns_window=11,
    threshold=50,
    sigma_smooth=2,
    nx_window=5,
    delta_flux=0,
    method=&#39;gaussian&#39;,
    degree_cdistortion=2,
    degree_wavecalib=3,
    peak_wavelengths=&lt;Quantity [6506.528, 6532.88 , 6598.953, 6652.09 , 6678.2  , 6717.043,
           6752.832, 6871.29 ] Angstrom&gt;,
    _nlines_reference=8,
    _naxis1=1024,
    _naxis2=250,
    _xpeaks_all_lines_array=array([[ 10.32905234,  77.80555129, 247.02193551, ..., 549.89121403,
        641.77328117, 946.83276802],
       [ 10.33260378,  77.81100587, 247.01588494, ..., 549.89207883,
        641.76059442, 946.82642287],
       [ 10.34568947,  77.81000046, 247.02368721, ..., 549.88797079,
        641.79459232, 946.80807042],
       ...,
       [ 10.87332486,  78.33716115, 247.54521942, ..., 550.4003933 ,
        642.31360776, 947.30193393],
       [ 10.87840224,  78.34162022, 247.54803766, ..., 550.40171927,
        642.33887363, 947.261077  ],
       [ 10.88042931,  78.34612774, 247.55216   , ..., 550.40582838,
        642.36933702, 947.36151689]], shape=(250, 8)),
    _valid_scans=array([ True,  True,  True,  True,  True,  True,  True,  True,  True,
        True,  True,  True,  True,  True,  True,  True,  True,  True,
        True,  True,  True,  True,  True,  True,  True,  True,  True,
        True,  True,  True,  True,  True,  True,  True,  True,  True,
        True,  True,  True,  True,  True,  True,  True,  True,  True,
        True,  True,  True,  True,  True,  True,  True,  True,  True,
        True,  True,  True,  True,  True,  True,  True,  True,  True,
        True,  True,  True,  True,  True,  True,  True,  True,  True,
        True,  True,  True,  True,  True,  True,  True,  True, False,
       False, False, False, False, False, False, False, False, False,
       False, False, False, False, False, False, False, False, False,
       False, False, False, False, False, False, False, False, False,
       False, False, False, False, False, False, False, False, False,
       False, False,  True,  True,  True,  True,  True,  True,  True,
        True,  True,  True,  True,  True,  True,  True,  True,  True,
        True,  True,  True,  True,  True,  True,  True,  True,  True,
        True,  True,  True,  True,  True,  True,  True,  True,  True,
        True,  True,  True,  True,  True,  True,  True,  True,  True,
        True,  True,  True,  True,  True,  True,  True,  True,  True,
        True,  True,  True,  True,  True,  True,  True,  True,  True,
       False, False, False, False, False, False, False, False, False,
       False, False, False, False, False, False, False, False, False,
       False,  True,  True,  True,  True,  True,  True,  True,  True,
        True,  True,  True,  True,  True,  True,  True,  True,  True,
        True,  True,  True,  True,  True,  True,  True,  True,  True,
        True,  True,  True,  True,  True,  True,  True,  True,  True,
        True,  True,  True,  True,  True,  True,  True,  True,  True,
        True,  True,  True,  True,  True,  True,  True]),
    _list_poly_cdistortion=[Polynomial([ 1.04290791e+01, -3.35373804e-03,  2.08528342e-05], domain=[-1.,  1.], window=[-1.,  1.], symbol=&#39;x&#39;), Polynomial([ 7.79112922e+01, -3.41127839e-03,  2.06453080e-05], domain=[-1.,  1.], window=[-1.,  1.], symbol=&#39;x&#39;), Polynomial([ 2.47137885e+02, -3.84749428e-03,  2.21246396e-05], domain=[-1.,  1.], window=[-1.,  1.], symbol=&#39;x&#39;), Polynomial([ 3.83311403e+02, -4.11520871e-03,  2.32906296e-05], domain=[-1.,  1.], window=[-1.,  1.], symbol=&#39;x&#39;), Polynomial([ 4.50423650e+02, -2.97686243e-03,  1.96822658e-05], domain=[-1.,  1.], window=[-1.,  1.], symbol=&#39;x&#39;), Polynomial([ 5.50006348e+02, -4.01762966e-03,  2.27052407e-05], domain=[-1.,  1.], window=[-1.,  1.], symbol=&#39;x&#39;), Polynomial([ 6.41948193e+02, -3.96551351e-03,  2.22975616e-05], domain=[-1.,  1.], window=[-1.,  1.], symbol=&#39;x&#39;), Polynomial([ 9.46946237e+02, -4.63707812e-03,  2.46937643e-05], domain=[-1.,  1.], window=[-1.,  1.], symbol=&#39;x&#39;)],
    _array_poly_wav=None,
    _array_poly_pix=None,
    _array_residual_std_wav=None,
    _array_residual_std_pix=None,
    _array_crval1_linear=None,
    _array_cdelt1_linear=None,
    _array_crmax1_linear=None
)
</pre></div>
</div>
</div>
</div>
<p>In the previous steps, we could also have used partial fits of the C distortion (using a low-degree polynomial) to predict the expected position of the lines. This should allow us to correct images with pronounced C distortion, for which using a single <code class="docutils literal notranslate"><span class="pre">xpeaks_reference</span></code> array may not be a good idea.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wavecalib</span><span class="o">.</span><span class="n">reset_image</span><span class="p">()</span>
<span class="n">wavecalib</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>TeaWaveCalibration(
    ns_window=11,
    threshold=50,
    sigma_smooth=2,
    nx_window=5,
    delta_flux=0,
    method=&#39;gaussian&#39;,
    degree_cdistortion=2,
    degree_wavecalib=3,
    peak_wavelengths=&lt;Quantity [6506.528, 6532.88 , 6598.953, 6652.09 , 6678.2  , 6717.043,
           6752.832, 6871.29 ] Angstrom&gt;,
    _nlines_reference=None,
    _naxis1=None,
    _naxis2=None,
    _xpeaks_all_lines_array=None,
    _valid_scans=None,
    _list_poly_cdistortion=None,
    _array_poly_wav=None,
    _array_poly_pix=None,
    _array_residual_std_wav=None,
    _array_residual_std_pix=None,
    _array_crval1_linear=None,
    _array_cdelt1_linear=None,
    _array_crmax1_linear=None
)
</pre></div>
</div>
</div>
</div>
<p>We start the procedure by fitting the spectra in the interval [1, 80].</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">ns_range1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>SliceRegion1D(slice(1, 80, None), mode=&quot;fits&quot;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wavecalib</span><span class="o">.</span><span class="n">compute_xpeaks_image</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
    <span class="n">xpeaks_reference</span><span class="o">=</span><span class="n">xpeaks_reference</span><span class="p">,</span>
    <span class="n">ns_range</span><span class="o">=</span><span class="n">ns_range1</span><span class="p">,</span>
    <span class="n">plots</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="n">input_filename</span><span class="p">,</span>
    <span class="n">disable_tqdm</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "00c17671251f461ab4a0d37db4cabeab"}</script><img alt="../../_images/b61664d292a5da8b999a881a3252a9fd5c22d32d7d3d5a2835893c1032a6978d.png" src="../../_images/b61664d292a5da8b999a881a3252a9fd5c22d32d7d3d5a2835893c1032a6978d.png" />
</div>
</div>
<p>We calculate the C distortion. In this case, extrapolating with a degree-2 polynomial (which introduces curvature) can be risky, and a more conservative option is to start with a degree-1 polynomial.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wavecalib</span><span class="o">.</span><span class="n">fit_cdistortion</span><span class="p">(</span><span class="n">degree_cdistortion</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">plots</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">input_filename</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/e7f291d09b027a9819377caa2ea7fa3eec6e8bd72412574163023f2f22525069.png" src="../../_images/e7f291d09b027a9819377caa2ea7fa3eec6e8bd72412574163023f2f22525069.png" />
</div>
</div>
<p>Using the <code class="docutils literal notranslate"><span class="pre">predict_cdistortion()</span></code> method, we can extrapolate the position of the lines for any spectrum, using the polynomials calculated so far to model the C distortion.</p>
<p>We can predict, for example, the expected position of the peaks for spectrum number 120 (following the FITS convention).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xpeaks_reference</span> <span class="o">=</span> <span class="n">wavecalib</span><span class="o">.</span><span class="n">predict_cdistortion</span><span class="p">(</span><span class="n">ns_fits</span><span class="o">=</span><span class="mi">120</span><span class="p">)</span>
<span class="n">xpeaks_reference</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[[10.307298,~77.773401,~246.97765,~383.11703,~450.31292,~549.82193,~641.76898,~946.75029] \; \mathrm{pix}\]</div>
</div>
</div>
<p>The new <code class="docutils literal notranslate"><span class="pre">xpeaks_reference</span></code> values will be a good estimate of the expected peak positions in spectrum number 120.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">ns_range2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>SliceRegion1D(slice(120, 180, None), mode=&quot;fits&quot;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wavecalib</span><span class="o">.</span><span class="n">compute_xpeaks_image</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
    <span class="n">xpeaks_reference</span><span class="o">=</span><span class="n">xpeaks_reference</span><span class="p">,</span>
    <span class="n">ns_range</span><span class="o">=</span><span class="n">ns_range2</span><span class="p">,</span>
    <span class="n">plots</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="n">input_filename</span><span class="p">,</span>
    <span class="n">disable_tqdm</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "8d253a9f674d4ffabcd6b584b81a3588"}</script><img alt="../../_images/d6b9481cf967d1c3ee6cb77a72d05a25b607803c203bb01a2283166b7c02f6c1.png" src="../../_images/d6b9481cf967d1c3ee6cb77a72d05a25b607803c203bb01a2283166b7c02f6c1.png" />
</div>
</div>
<p>We can now increase the degree of the polynomial to fit the C distortion.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wavecalib</span><span class="o">.</span><span class="n">fit_cdistortion</span><span class="p">(</span><span class="n">degree_cdistortion</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">plots</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">input_filename</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/88159d9a741a869dcaf3dfcb32d4b1ff3df1baac6222002c3eba3d566bdd87fe.png" src="../../_images/88159d9a741a869dcaf3dfcb32d4b1ff3df1baac6222002c3eba3d566bdd87fe.png" />
</div>
</div>
<p>We once again predict the peak positions, this time for spectrum number 200.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xpeaks_reference</span> <span class="o">=</span> <span class="n">wavecalib</span><span class="o">.</span><span class="n">predict_cdistortion</span><span class="p">(</span><span class="n">ns_fits</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
<span class="n">xpeaks_reference</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[[10.548158,~78.009788,~247.20399,~383.43698,~450.56845,~550.06469,~642.03262,~946.88107] \; \mathrm{pix}\]</div>
</div>
</div>
<p>We now search for the peaks in the last spatial interval.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">ns_range3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>SliceRegion1D(slice(200, 250, None), mode=&quot;fits&quot;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wavecalib</span><span class="o">.</span><span class="n">compute_xpeaks_image</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
    <span class="n">xpeaks_reference</span><span class="o">=</span><span class="n">xpeaks_reference</span><span class="p">,</span>
    <span class="n">ns_range</span><span class="o">=</span><span class="n">ns_range3</span><span class="p">,</span>
    <span class="n">plots</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="n">input_filename</span><span class="p">,</span>
    <span class="n">disable_tqdm</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "71ffd4dc719d4ab69c8fb495b487a991"}</script><img alt="../../_images/808bc4eb5b706cc5851829e30bfe22b0712c809f0560477e8f702a953eb0c16f.png" src="../../_images/808bc4eb5b706cc5851829e30bfe22b0712c809f0560477e8f702a953eb0c16f.png" />
</div>
</div>
<p>We finish with the calculation of distortion C.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wavecalib</span><span class="o">.</span><span class="n">fit_cdistortion</span><span class="p">(</span><span class="n">plots</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">input_filename</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/57d1de162b84028f9a29b5d6b3d06a07c697071007b26018d177de876c170acc.png" src="../../_images/57d1de162b84028f9a29b5d6b3d06a07c697071007b26018d177de876c170acc.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wavecalib</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>TeaWaveCalibration(
    ns_window=11,
    threshold=50,
    sigma_smooth=2,
    nx_window=5,
    delta_flux=0,
    method=&#39;gaussian&#39;,
    degree_cdistortion=2,
    degree_wavecalib=3,
    peak_wavelengths=&lt;Quantity [6506.528, 6532.88 , 6598.953, 6652.09 , 6678.2  , 6717.043,
           6752.832, 6871.29 ] Angstrom&gt;,
    _nlines_reference=8,
    _naxis1=1024,
    _naxis2=250,
    _xpeaks_all_lines_array=array([[ 10.32905234,  77.80555129, 247.02193551, ..., 549.89121403,
        641.77328117, 946.83276802],
       [ 10.33260378,  77.81100587, 247.01588494, ..., 549.89207883,
        641.76059442, 946.82642287],
       [ 10.34568947,  77.81000046, 247.02368721, ..., 549.88797079,
        641.79459232, 946.80807042],
       ...,
       [ 10.87332486,  78.33716115, 247.54521942, ..., 550.4003933 ,
        642.31360776, 947.30193393],
       [ 10.87840224,  78.34162022, 247.54803766, ..., 550.40171927,
        642.33887363, 947.261077  ],
       [ 10.88042931,  78.34612774, 247.55216   , ..., 550.40582838,
        642.36933702, 947.36151689]], shape=(250, 8)),
    _valid_scans=array([ True,  True,  True,  True,  True,  True,  True,  True,  True,
        True,  True,  True,  True,  True,  True,  True,  True,  True,
        True,  True,  True,  True,  True,  True,  True,  True,  True,
        True,  True,  True,  True,  True,  True,  True,  True,  True,
        True,  True,  True,  True,  True,  True,  True,  True,  True,
        True,  True,  True,  True,  True,  True,  True,  True,  True,
        True,  True,  True,  True,  True,  True,  True,  True,  True,
        True,  True,  True,  True,  True,  True,  True,  True,  True,
        True,  True,  True,  True,  True,  True,  True,  True, False,
       False, False, False, False, False, False, False, False, False,
       False, False, False, False, False, False, False, False, False,
       False, False, False, False, False, False, False, False, False,
       False, False, False, False, False, False, False, False, False,
       False, False,  True,  True,  True,  True,  True,  True,  True,
        True,  True,  True,  True,  True,  True,  True,  True,  True,
        True,  True,  True,  True,  True,  True,  True,  True,  True,
        True,  True,  True,  True,  True,  True,  True,  True,  True,
        True,  True,  True,  True,  True,  True,  True,  True,  True,
        True,  True,  True,  True,  True,  True,  True,  True,  True,
        True,  True,  True,  True,  True,  True,  True,  True,  True,
       False, False, False, False, False, False, False, False, False,
       False, False, False, False, False, False, False, False, False,
       False,  True,  True,  True,  True,  True,  True,  True,  True,
        True,  True,  True,  True,  True,  True,  True,  True,  True,
        True,  True,  True,  True,  True,  True,  True,  True,  True,
        True,  True,  True,  True,  True,  True,  True,  True,  True,
        True,  True,  True,  True,  True,  True,  True,  True,  True,
        True,  True,  True,  True,  True,  True,  True]),
    _list_poly_cdistortion=[Polynomial([ 1.04290791e+01, -3.35373804e-03,  2.08528342e-05], domain=[-1.,  1.], window=[-1.,  1.], symbol=&#39;x&#39;), Polynomial([ 7.79112922e+01, -3.41127839e-03,  2.06453080e-05], domain=[-1.,  1.], window=[-1.,  1.], symbol=&#39;x&#39;), Polynomial([ 2.47137885e+02, -3.84749428e-03,  2.21246396e-05], domain=[-1.,  1.], window=[-1.,  1.], symbol=&#39;x&#39;), Polynomial([ 3.83311403e+02, -4.11520871e-03,  2.32906296e-05], domain=[-1.,  1.], window=[-1.,  1.], symbol=&#39;x&#39;), Polynomial([ 4.50423650e+02, -2.97686243e-03,  1.96822658e-05], domain=[-1.,  1.], window=[-1.,  1.], symbol=&#39;x&#39;), Polynomial([ 5.50006348e+02, -4.01762966e-03,  2.27052407e-05], domain=[-1.,  1.], window=[-1.,  1.], symbol=&#39;x&#39;), Polynomial([ 6.41948193e+02, -3.96551351e-03,  2.22975616e-05], domain=[-1.,  1.], window=[-1.,  1.], symbol=&#39;x&#39;), Polynomial([ 9.46946237e+02, -4.63707812e-03,  2.46937643e-05], domain=[-1.,  1.], window=[-1.,  1.], symbol=&#39;x&#39;)],
    _array_poly_wav=None,
    _array_poly_pix=None,
    _array_residual_std_wav=None,
    _array_residual_std_pix=None,
    _array_crval1_linear=None,
    _array_cdelt1_linear=None,
    _array_crmax1_linear=None
)
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="wavelength-calibration-calculation-for-the-entire-image">
<h2>Wavelength Calibration Calculation for the Entire Image<a class="headerlink" href="#wavelength-calibration-calculation-for-the-entire-image" title="Link to this heading">#</a></h2>
<p>Once a good modeling of the C distortion has been obtained for a specific number of lines, the only remaining step is to evaluate, for each spectrum, the expected position of the lines. The wavelengths of these lines are then fitted based on the position of the peaks, for all spectra in the image. This then provides a wavelength calibration polynomial for each spectrum.</p>
<p>This task is performed automatically using the <code class="docutils literal notranslate"><span class="pre">fit_wavelengths()</span></code> method.</p>
<p>The calibration polynomials are stored in an auxiliary FITS file with the following format:</p>
<ul class="simple">
<li><p>Primary HDU: an image is saved in which each row contains the coefficients of the <code class="docutils literal notranslate"><span class="pre">wavelength(pixel)</span></code> polynomial. That is, <code class="docutils literal notranslate"><span class="pre">NAXIS1</span></code> is equal to the degree of the wavelength calibration polynomial plus one (<code class="docutils literal notranslate"><span class="pre">degree_wavecalib+1</span></code>), while <code class="docutils literal notranslate"><span class="pre">NAXIS2</span></code> remains the number of spectra in the original FITS image.</p></li>
<li><p>Second HDU (extension number 1, <code class="docutils literal notranslate"><span class="pre">INV_POLY</span></code>): contains the coefficients of the <code class="docutils literal notranslate"><span class="pre">pixel(wavelength)</span></code> polynomial, which is the one actually fitted when calculating the wavelength calibration.</p></li>
<li><p>Third HDU (extension number 2, <code class="docutils literal notranslate"><span class="pre">CDISTOR</span></code>): contains the coefficients of the polynomials fitted to each spectral line (C distortion).</p></li>
<li><p>Fourth HDU (extension number 3, <code class="docutils literal notranslate"><span class="pre">COEFF</span></code>): contains a binary table with five columns:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">residual_std_wav</span></code>: residual standard deviation of the fit to the <code class="docutils literal notranslate"><span class="pre">wavelength(pixel)</span></code> polynomial.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">residual_std_pix</span></code>: residual standard deviation of the fit to the <code class="docutils literal notranslate"><span class="pre">pixel(wavelength)</span></code> polynomial.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">crval1_linear</span></code>: value of the FITS keyword <code class="docutils literal notranslate"><span class="pre">CRVAL1</span></code>, which stores the wavelength at the center of the first pixel (here we always assume the reference pixel is <code class="docutils literal notranslate"><span class="pre">CRPIX1=1</span></code>), in the linear approximation.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cdelt1_linear</span></code>: value of the FITS keyword <code class="docutils literal notranslate"><span class="pre">CDELT1</span></code>, which stores the reciprocal linear dispersion, evaluated in the linear approximation.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">crmax1_linear</span></code>: value of the wavelength at the center of pixel number <code class="docutils literal notranslate"><span class="pre">NAXIS1</span></code>, calculated assuming the linear approximation.</p></li>
</ul>
</li>
</ul>
<p>We perform the wavelength calibration. During the process, auxiliary plots are shown (<code class="docutils literal notranslate"><span class="pre">plots=True</span></code>) with the values of <code class="docutils literal notranslate"><span class="pre">crval1_linear</span></code>, <code class="docutils literal notranslate"><span class="pre">cdelt1_linear</span></code>, <code class="docutils literal notranslate"><span class="pre">crmax1_linear</span></code>, and <code class="docutils literal notranslate"><span class="pre">residual_std</span></code>, as well as the various coefficients of the wavelength calibration polynomial, as a function of the spectrum number.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># define additional information for the image header</span>
<span class="n">history_list</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;Wavelength calibration&#39;</span><span class="p">,</span>
    <span class="sa">f</span><span class="s1">&#39;Input file: </span><span class="si">{</span><span class="n">input_filename</span><span class="si">}</span><span class="s1">&#39;</span>
<span class="p">]</span>

<span class="c1"># name of the auxiliary FITS file</span>
<span class="n">wavecal_filename</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;wavecal_</span><span class="si">{</span><span class="n">input_filename</span><span class="si">}</span><span class="s1">&#39;</span>

<span class="c1"># compute wavelength calibration and save result in auxiliary FITS file</span>
<span class="n">wavecalib</span><span class="o">.</span><span class="n">fit_wavelengths</span><span class="p">(</span>
    <span class="n">output_filename</span><span class="o">=</span><span class="n">wavecal_filename</span><span class="p">,</span> 
    <span class="n">history_list</span><span class="o">=</span><span class="n">history_list</span><span class="p">,</span>
    <span class="n">plots</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="n">input_filename</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&gt;&gt;&gt; minimum CRVAL1 linear: 6502.2803275485685 Angstrom
&gt;&gt;&gt; maximum CRMAX1 linear: 6900.851045180412 Angstrom
&gt;&gt;&gt; mean CDELT1..........: 0.38960969465478373 Angstrom
--&gt; Saving result in FITS file: wavecal_ftdz_45324.fits
</pre></div>
</div>
<img alt="../../_images/73f6b534006bad9fa74d7dfd7e1a098c798a84d9bd69aa802b78997c23447fa8.png" src="../../_images/73f6b534006bad9fa74d7dfd7e1a098c798a84d9bd69aa802b78997c23447fa8.png" />
<img alt="../../_images/1110c8a877a11d6a9a9b19bbf0471c2ec7c13f25179fbaded1bae3817d0bc7c9.png" src="../../_images/1110c8a877a11d6a9a9b19bbf0471c2ec7c13f25179fbaded1bae3817d0bc7c9.png" />
</div>
</div>
</section>
<section id="reading-the-calibration-from-the-auxiliary-fits-file">
<h2>Reading the Calibration from the Auxiliary FITS File<a class="headerlink" href="#reading-the-calibration-from-the-auxiliary-fits-file" title="Link to this heading">#</a></h2>
<p>We can verify that the calibration we generated has been correctly stored in the auxiliary FITS file. To do this, we will create a new instance <code class="docutils literal notranslate"><span class="pre">wavecalib_bis</span></code> of the <code class="docutils literal notranslate"><span class="pre">TeaWaveCalibration</span></code> class, initializing it directly with the information stored in that file. Further below, we will check that the wavelength calibration it provides is the same as the one obtained from the initial <code class="docutils literal notranslate"><span class="pre">wavecalib</span></code> object.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wavecalib_bis</span> <span class="o">=</span> <span class="n">tea</span><span class="o">.</span><span class="n">TeaWaveCalibration</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">wavecal_filename</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&gt;&gt;&gt; Reading file.........: wavecal_ftdz_45324.fits
&gt;&gt;&gt; minimum CRVAL1 linear: 6502.2803275485685 Angstrom
&gt;&gt;&gt; maximum CRMAX1 linear: 6900.851045180412 Angstrom
&gt;&gt;&gt; mean CDELT1..........: 0.38960969465478373 Angstrom
</pre></div>
</div>
</div>
</div>
</section>
<section id="applying-the-wavelength-calibration">
<h2>Applying the Wavelength Calibration<a class="headerlink" href="#applying-the-wavelength-calibration" title="Link to this heading">#</a></h2>
<p>Once all the wavelength calibration polynomials have been calculated, they just need to be applied to the images to be corrected. We can immediately apply the correction to the arc image.</p>
<p>Note that this procedure simultaneously corrects for C distortion and performs resampling on a linear wavelength scale. This method therefore does not require resampling the data twice: that is, it is not necessary to first correct for C distortion (which involves resampling) and then apply the wavelength calibration (which would again involve resampling the signal). By performing both tasks at once, we avoid correlating the errors twice.</p>
<p>Wavelength calibration requires providing two fundamental parameters:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">CRVAL1</span></code>: wavelength at the center of the first pixel (we are assuming <code class="docutils literal notranslate"><span class="pre">CRPIX1=1</span></code>).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CDELT1</span></code>: reciprocal linear dispersion, constant throughout the resulting spectrum.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">crval1</span> <span class="o">=</span> <span class="mi">6502</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">Angstrom</span>
<span class="n">cdelt1</span> <span class="o">=</span> <span class="mf">0.390</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">Angstrom</span> <span class="o">/</span> <span class="n">u</span><span class="o">.</span><span class="n">pixel</span>
</pre></div>
</div>
</div>
</div>
<p>We are going to run the procedure twice: this way we can verify that the result is the same whether we use the <code class="docutils literal notranslate"><span class="pre">wavecalib</span></code> object or <code class="docutils literal notranslate"><span class="pre">wavecalib_bis</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_wavecalib</span> <span class="o">=</span> <span class="n">wavecalib</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> 
    <span class="n">crval1</span><span class="o">=</span><span class="n">crval1</span><span class="p">,</span> 
    <span class="n">cdelt1</span><span class="o">=</span><span class="n">cdelt1</span><span class="p">,</span> 
    <span class="n">disable_tqdm</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>

<span class="n">data_wavecalib_bis</span> <span class="o">=</span> <span class="n">wavecalib_bis</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> 
    <span class="n">crval1</span><span class="o">=</span><span class="n">crval1</span><span class="p">,</span> 
    <span class="n">cdelt1</span><span class="o">=</span><span class="n">cdelt1</span><span class="p">,</span> 
    <span class="n">disable_tqdm</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&gt;&gt;&gt; Using CDELT1: 1 pix
&gt;&gt;&gt; Using CRVAL1: 6502.0 Angstrom
&gt;&gt;&gt; Using CDELT1: 0.39 Angstrom / pix
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "0f84d1ebae8b42eabf65871e50672cd8"}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&gt;&gt;&gt; Using CDELT1: 1 pix
&gt;&gt;&gt; Using CRVAL1: 6502.0 Angstrom
&gt;&gt;&gt; Using CDELT1: 0.39 Angstrom / pix
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "acc603497d9c447c8d4fa8461a17632b"}</script></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># difference between both calibrated arrays</span>
<span class="n">diff</span> <span class="o">=</span> <span class="n">data_wavecalib</span> <span class="o">-</span> <span class="n">data_wavecalib_bis</span>
<span class="nb">print</span><span class="p">(</span><span class="n">diff</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">diff</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.0 0.0
</pre></div>
</div>
</div>
</div>
<p>We save the calibrated image to a FITS file. It is important not to forget to include in the FITS header the keywords that indicate the image is wavelength-calibrated. In this case, we take the <em>header</em> of the image (before being wavelength-calibrated) and complement it with the <em>keywords</em> <code class="docutils literal notranslate"><span class="pre">CRPIX1</span></code>, <code class="docutils literal notranslate"><span class="pre">CRVAL1</span></code>, <code class="docutils literal notranslate"><span class="pre">CDELT1</span></code>, <code class="docutils literal notranslate"><span class="pre">CUNIT1</span></code>, and <code class="docutils literal notranslate"><span class="pre">CTYPE1</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">header</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">getheader</span><span class="p">(</span><span class="n">input_filename</span><span class="p">)</span>
<span class="n">header</span><span class="p">[</span><span class="s1">&#39;CRPIX1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">u</span><span class="o">.</span><span class="n">pixel</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">header</span><span class="p">[</span><span class="s1">&#39;CRVAL1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">crval1</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">crval1</span><span class="o">.</span><span class="n">unit</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">header</span><span class="p">[</span><span class="s1">&#39;CDELT1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">cdelt1</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">cdelt1</span><span class="o">.</span><span class="n">unit</span><span class="si">}</span><span class="s1">&#39;</span> <span class="p">)</span>
<span class="n">header</span><span class="p">[</span><span class="s1">&#39;CUNIT1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">crval1</span><span class="o">.</span><span class="n">unit</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;wavelength unit&#39;</span><span class="p">)</span>
<span class="n">header</span><span class="p">[</span><span class="s1">&#39;CTYPE1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;AWAV&#39;</span><span class="p">,</span> <span class="s1">&#39;air wavelength&#39;</span><span class="p">)</span>   

<span class="n">hdu</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">PrimaryHDU</span><span class="p">(</span><span class="n">header</span><span class="o">=</span><span class="n">header</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data_wavecalib</span><span class="p">)</span>
<span class="n">hdul</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">HDUList</span><span class="p">([</span><span class="n">hdu</span><span class="p">])</span>
<span class="n">hdul</span><span class="o">.</span><span class="n">writeto</span><span class="p">(</span><span class="s1">&#39;dummy.fits&#39;</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We verify that the flux is preserved by calculating and plotting a total cross-section of the image in the spatial direction before and after applying the wavelength calibration.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;original data&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">data_wavecalib</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;WL calibrated data&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Y axis (array index)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;np.sum(data, axis=1)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x7fac459c6c90&gt;
</pre></div>
</div>
<img alt="../../_images/8bcc02a09988a915d662aca6146163cd8899a7f3f4411a8dfcf5304108e845ba.png" src="../../_images/8bcc02a09988a915d662aca6146163cd8899a7f3f4411a8dfcf5304108e845ba.png" />
</div>
</div>
<p>The result is the same using <code class="docutils literal notranslate"><span class="pre">wavecalib</span></code> and <code class="docutils literal notranslate"><span class="pre">wavecalib_bis</span></code> (within rounding error).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">data_wavecalib</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Y axis (array index)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;difference&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;difference&#39;)
</pre></div>
</div>
<img alt="../../_images/aace685b2965115b59f77ab43dd81521603952763d24e4749c39fd4674ed515c.png" src="../../_images/aace685b2965115b59f77ab43dd81521603952763d24e4749c39fd4674ed515c.png" />
</div>
</div>
</section>
<section id="graphical-check">
<h2>Graphical Check<a class="headerlink" href="#graphical-check" title="Link to this heading">#</a></h2>
<p>In the vicinity of each line, we will display the image before and after correcting for C distortion and calibrating in wavelength.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">wavecalib</span></code> object has a method <code class="docutils literal notranslate"><span class="pre">plot_data_comparison()</span></code> that graphically represents the image before/after wavelength calibration around each line (the function includes a parameter <code class="docutils literal notranslate"><span class="pre">semi_window</span></code>, which by default is <code class="docutils literal notranslate"><span class="pre">nx_window</span></code>, and determines the window, in pixels, to be used).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wavecalib</span><span class="o">.</span><span class="n">plot_data_comparison</span><span class="p">(</span>
    <span class="n">data_before</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
    <span class="n">data_after</span><span class="o">=</span><span class="n">data_wavecalib</span><span class="p">,</span>
    <span class="n">crval1</span><span class="o">=</span><span class="n">crval1</span><span class="p">,</span>
    <span class="n">cdelt1</span><span class="o">=</span><span class="n">cdelt1</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Wavelength calibration of </span><span class="si">{</span><span class="n">input_filename</span><span class="si">}</span><span class="s1">&#39;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/c5331bd5509236114f994a4b55ff58dfcdc018fa4193e4577cb77b21804fc887.png" src="../../_images/c5331bd5509236114f994a4b55ff58dfcdc018fa4193e4577cb77b21804fc887.png" />
<img alt="../../_images/a5fbc22f0edf33799dccc924d9fa541114d608d0ecc74a561f1c6fc953391aa4.png" src="../../_images/a5fbc22f0edf33799dccc924d9fa541114d608d0ecc74a561f1c6fc953391aa4.png" />
<img alt="../../_images/2428e00f3e6d594a916ae8ba7a50120764ff25d6e6e48caa56ff794b78a1dce8.png" src="../../_images/2428e00f3e6d594a916ae8ba7a50120764ff25d6e6e48caa56ff794b78a1dce8.png" />
<img alt="../../_images/bb50f479882464045ebaa7fbdcf7a7eb2354529c42e95faaa7ae13bb0b2f737c.png" src="../../_images/bb50f479882464045ebaa7fbdcf7a7eb2354529c42e95faaa7ae13bb0b2f737c.png" />
<img alt="../../_images/6bad5f4aca954e689d163ae10177ff4a462a64040ebff12b0ec53c44daab15cd.png" src="../../_images/6bad5f4aca954e689d163ae10177ff4a462a64040ebff12b0ec53c44daab15cd.png" />
<img alt="../../_images/459bc6befb955143ce61b1e014555958a1c59e7db733478c113f9dbb7920a98e.png" src="../../_images/459bc6befb955143ce61b1e014555958a1c59e7db733478c113f9dbb7920a98e.png" />
<img alt="../../_images/a384dc5bb738d2d3fa2f789c14b2f31e4b17ba49b27063c4bd2a34d1eabeea4b.png" src="../../_images/a384dc5bb738d2d3fa2f789c14b2f31e4b17ba49b27063c4bd2a34d1eabeea4b.png" />
<img alt="../../_images/a8d31df3da7af280aa98d3b080c7e93d0a414b77002dade15fba121868ec78fe.png" src="../../_images/a8d31df3da7af280aa98d3b080c7e93d0a414b77002dade15fba121868ec78fe.png" />
</div>
</div>
<p>The lines have been straightened: each one shows a slight global shift in the spectral direction (note how the scale on the X-axis changes) due to resampling when converting to a linear wavelength scale.</p>
</section>
<section id="numerical-check">
<h2>Numerical Check<a class="headerlink" href="#numerical-check" title="Link to this heading">#</a></h2>
<p>We calibrate in wavelength the image that has already been calibrated. We perform a new calibration process.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wavecalib</span> <span class="o">=</span> <span class="n">tea</span><span class="o">.</span><span class="n">TeaWaveCalibration</span><span class="p">()</span>
<span class="n">wavecalib</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>TeaWaveCalibration(
    ns_window=11,
    threshold=0,
    sigma_smooth=0,
    nx_window=5,
    delta_flux=0,
    method=&#39;gaussian&#39;,
    degree_cdistortion=1,
    degree_wavecalib=1,
    peak_wavelengths=None,
    _nlines_reference=None,
    _naxis1=None,
    _naxis2=None,
    _xpeaks_all_lines_array=None,
    _valid_scans=None,
    _list_poly_cdistortion=None,
    _array_poly_wav=None,
    _array_poly_pix=None,
    _array_residual_std_wav=None,
    _array_residual_std_pix=None,
    _array_crval1_linear=None,
    _array_cdelt1_linear=None,
    _array_crmax1_linear=None
)
</pre></div>
</div>
</div>
</div>
<p>We use the parameters (<code class="docutils literal notranslate"><span class="pre">threshold</span></code>, <code class="docutils literal notranslate"><span class="pre">sigma_smooth</span></code>) that we already know produce a good detection of the relevant peaks.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">ns_range</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>SliceRegion1D(slice(120, 130, None), mode=&quot;fits&quot;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xpeaks_reference</span><span class="p">,</span> <span class="n">ixpeaks_reference</span><span class="p">,</span> <span class="n">spectrum_reference</span> <span class="o">=</span> <span class="n">wavecalib</span><span class="o">.</span><span class="n">compute_xpeaks_reference</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="n">data_wavecalib</span><span class="p">,</span>
    <span class="n">ns_range</span><span class="o">=</span><span class="n">ns_range</span><span class="p">,</span>
    <span class="n">threshold</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
    <span class="n">sigma_smooth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">plot_spectrum</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">plot_peaks</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/f4fa45009b49f404ea430e4e61228ce3b01377050d4ccf58069fadd59e99f6a2.png" src="../../_images/f4fa45009b49f404ea430e4e61228ce3b01377050d4ccf58069fadd59e99f6a2.png" />
<img alt="../../_images/cf29ffe1ded3c49e260aa2720b0f09d2ab95de70f3217757218fcdbf116a3649.png" src="../../_images/cf29ffe1ded3c49e260aa2720b0f09d2ab95de70f3217757218fcdbf116a3649.png" />
</div>
</div>
<p>The positions of the peaks and their wavelengths are the same as those used above.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xpeaks_reference</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[[11.583269,~79.164359,~248.55148,~384.75315,~451.9225,~551.33444,~643.08965,~946.86031] \; \mathrm{pix}\]</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wavelengths_reference</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[[6506.528,~6532.88,~6598.953,~6652.09,~6678.2,~6717.043,~6752.832,~6871.29] \; \mathrm{\mathring{A}}\]</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wavecalib</span><span class="o">.</span><span class="n">define_peak_wavelengths</span><span class="p">(</span>
    <span class="n">xpeaks</span><span class="o">=</span><span class="n">xpeaks_reference</span><span class="p">,</span>
    <span class="n">wavelengths</span><span class="o">=</span> <span class="n">wavelengths_reference</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We calculate the wavelength calibration polynomial corresponding to the positions of the peaks we have found.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">poly_fits_wav</span><span class="p">,</span> <span class="n">residual_std_wav</span><span class="p">,</span> <span class="n">poly_fits_pix</span><span class="p">,</span> <span class="n">residual_std_pix</span><span class="p">,</span> \
<span class="n">crval1_linear</span><span class="p">,</span> <span class="n">cdelt1_linear</span><span class="p">,</span> <span class="n">crmax1_linear</span> <span class="o">=</span> <span class="n">wavecalib</span><span class="o">.</span><span class="n">fit_xpeaks_wavelengths</span><span class="p">(</span>
    <span class="n">xpeaks</span><span class="o">=</span><span class="n">xpeaks_reference</span><span class="p">,</span> 
    <span class="n">degree_wavecalib</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">debug</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">plots</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Recomputing calibration in calibrated </span><span class="si">{</span><span class="n">input_filename</span><span class="si">}</span><span class="s1">&#39;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&gt;&gt;&gt; CRPIX1.............: 1.0 pix
&gt;&gt;&gt; CRVAL1 linear scale: 6502.0075707439155 Angstrom
&gt;&gt;&gt; CDELT1 linear scale: 0.390007344643242 Angstrom / pix
&gt;&gt;&gt; CRMAX1 linear scale: 6900.985084313952 Angstrom

&gt;&gt;&gt; Fitted coefficients pixel(wavelength):
 [-1.66705003e+04  2.56405428e+00]
&gt;&gt;&gt; Residual std.........................: 0.07231952867838005 pix

&gt;&gt;&gt; Fitted coefficients wavelength(pixel):
 [6.50161756e+03 3.90007345e-01]
&gt;&gt;&gt; Residual std.........................: 0.028205147345705794 Angstrom
</pre></div>
</div>
<img alt="../../_images/e1ea4bcb264e96e26a4347f985bf5e51792577a188bf33c46280a5c92abcb8ab.png" src="../../_images/e1ea4bcb264e96e26a4347f985bf5e51792577a188bf33c46280a5c92abcb8ab.png" />
</div>
</div>
<p>We see that <code class="docutils literal notranslate"><span class="pre">CRVAL1_linear</span></code> and <code class="docutils literal notranslate"><span class="pre">CDELT1_linear</span></code> are very close to the values of <code class="docutils literal notranslate"><span class="pre">CRVAL1</span></code> and <code class="docutils literal notranslate"><span class="pre">CDELT1</span></code> that we used above to obtain the wavelength-calibrated image (which makes sense: the image is already calibrated in wavelength).</p>
<p>We now proceed to adjust the position of all the lines in the image.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wavecalib</span><span class="o">.</span><span class="n">compute_xpeaks_image</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="n">data_wavecalib</span><span class="p">,</span> 
    <span class="n">xpeaks_reference</span><span class="o">=</span><span class="n">xpeaks_reference</span><span class="p">,</span> 
    <span class="n">plots</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">disable_tqdm</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Recomputing xpeaks in calibrated </span><span class="si">{</span><span class="n">input_filename</span><span class="si">}</span><span class="s1">&#39;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "6007650e115b4364ba2d8c919b13ce13"}</script><img alt="../../_images/9cb54c6648d972ad0c9fb10a7e8ad0d818f34852a48e7870a10e3acc59a86251.png" src="../../_images/9cb54c6648d972ad0c9fb10a7e8ad0d818f34852a48e7870a10e3acc59a86251.png" />
</div>
</div>
<p>We calculate and adjust the C distortion.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wavecalib</span><span class="o">.</span><span class="n">fit_cdistortion</span><span class="p">(</span>
    <span class="n">plots</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Recomputing C distortion in calibrated </span><span class="si">{</span><span class="n">input_filename</span><span class="si">}</span><span class="s1">&#39;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/fae88a165b1b8ed35710213c5010b2c19c1a54a9515b123b0050954eae75d23f.png" src="../../_images/fae88a165b1b8ed35710213c5010b2c19c1a54a9515b123b0050954eae75d23f.png" />
</div>
</div>
<p>The polynomials obtained are very vertical: there is no noticeable distortion.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wavecalib</span><span class="o">.</span><span class="n">_list_poly_cdistortion</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[Polynomial([1.15930635e+01, 1.28067231e-04], domain=[-1.,  1.], window=[-1.,  1.], symbol=&#39;x&#39;),
 Polynomial([ 7.91849325e+01, -2.68337004e-05], domain=[-1.,  1.], window=[-1.,  1.], symbol=&#39;x&#39;),
 Polynomial([ 2.48576606e+02, -3.62737523e-05], domain=[-1.,  1.], window=[-1.,  1.], symbol=&#39;x&#39;),
 Polynomial([ 3.84823325e+02, -2.06869663e-04], domain=[-1.,  1.], window=[-1.,  1.], symbol=&#39;x&#39;),
 Polynomial([4.51944100e+02, 9.84152132e-06], domain=[-1.,  1.], window=[-1.,  1.], symbol=&#39;x&#39;),
 Polynomial([ 5.51362468e+02, -5.04764974e-05], domain=[-1.,  1.], window=[-1.,  1.], symbol=&#39;x&#39;),
 Polynomial([6.43115049e+02, 3.61309383e-05], domain=[-1.,  1.], window=[-1.,  1.], symbol=&#39;x&#39;),
 Polynomial([9.46890352e+02, 7.51850422e-05], domain=[-1.,  1.], window=[-1.,  1.], symbol=&#39;x&#39;)]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wavecalib</span><span class="o">.</span><span class="n">plot_cdistortion</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="n">data_wavecalib</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Recomputing C distortion in calibrated </span><span class="si">{</span><span class="n">input_filename</span><span class="si">}</span><span class="s1">&#39;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/76efc0398e178bf2f6cf5766d8398d929cc930ebb206b1444c321966c01ad240.png" src="../../_images/76efc0398e178bf2f6cf5766d8398d929cc930ebb206b1444c321966c01ad240.png" />
</div>
</div>
</section>
<section id="applying-the-calibration-to-a-ccddata-object">
<h2>Applying the Calibration to a <code class="docutils literal notranslate"><span class="pre">CCDData</span></code> Object<a class="headerlink" href="#applying-the-calibration-to-a-ccddata-object" title="Link to this heading">#</a></h2>
<p>We read the calibration stored in the auxiliary FITS file.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">wavecal_filename</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>wavecal_ftdz_45324.fits
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wavecalib</span> <span class="o">=</span> <span class="n">tea</span><span class="o">.</span><span class="n">TeaWaveCalibration</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">wavecal_filename</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&gt;&gt;&gt; Reading file.........: wavecal_ftdz_45324.fits
&gt;&gt;&gt; minimum CRVAL1 linear: 6502.2803275485685 Angstrom
&gt;&gt;&gt; maximum CRMAX1 linear: 6900.851045180412 Angstrom
&gt;&gt;&gt; mean CDELT1..........: 0.38960969465478373 Angstrom
</pre></div>
</div>
</div>
</div>
<p>In case you want to apply this calibration to an instance of type <code class="docutils literal notranslate"><span class="pre">CCDData</span></code>, it is important to remember that these objects can store different arrays. In particular, the FITS file containing the reduced arc exposure we have been working with contains several extensions.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">input_filename</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ftdz_45324.fits
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fits</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">input_filename</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Filename: ftdz_45324.fits
No.    Name      Ver    Type      Cards   Dimensions   Format
  0  PRIMARY       1 PrimaryHDU     171   (1024, 250)   float64   
  1  MASK          1 ImageHDU         8   (1024, 250)   uint8   
  2  UNCERT        1 ImageHDU         9   (1024, 250)   float64   
</pre></div>
</div>
</div>
</div>
<p>We are going to apply the calibration to the 3 present extensions. When doing so on the <code class="docutils literal notranslate"><span class="pre">UNCERT</span></code> extension, we will introduce uncertainty correlation, which makes its propagation incorrect. In any case, we execute it here to get a first estimate of it.</p>
<p>We read the complete information from the FITS file and generate an instance of type <code class="docutils literal notranslate"><span class="pre">CCDData</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ccdimage</span> <span class="o">=</span> <span class="n">CCDData</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">input_filename</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The mask we have read is completely filled with <code class="docutils literal notranslate"><span class="pre">False</span></code> values.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ccdimage</span><span class="o">.</span><span class="n">mask</span><span class="o">.</span><span class="n">any</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>np.False_
</pre></div>
</div>
</div>
</div>
<p>To verify that the calibration is also applied to the mask, we set to <code class="docutils literal notranslate"><span class="pre">True</span></code> the pixels corresponding to the peaks of the lines (using the prediction from the distortion C calibration polynomials).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">iline</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">wavecalib</span><span class="o">.</span><span class="n">_nlines_reference</span><span class="p">):</span>
    <span class="n">indices</span> <span class="o">=</span> <span class="p">(</span><span class="n">wavecalib</span><span class="o">.</span><span class="n">_list_poly_cdistortion</span><span class="p">[</span><span class="n">iline</span><span class="p">](</span><span class="nb">range</span><span class="p">(</span><span class="n">wavecalib</span><span class="o">.</span><span class="n">_naxis2</span><span class="p">))</span><span class="o">+</span><span class="mf">0.5</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
    <span class="n">ccdimage</span><span class="o">.</span><span class="n">mask</span><span class="p">[:,</span> <span class="n">indices</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
</pre></div>
</div>
</div>
</div>
<p>We display the mask by converting the boolean array into another one of real numbers, using NumPy’s <code class="docutils literal notranslate"><span class="pre">astype(float)</span></code> method.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span>
<span class="n">img</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">ccdimage</span><span class="o">.</span><span class="n">mask</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">),</span> 
                <span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> 
                <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">)</span>
<span class="n">divider</span> <span class="o">=</span> <span class="n">make_axes_locatable</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
<span class="n">cax</span> <span class="o">=</span> <span class="n">divider</span><span class="o">.</span><span class="n">append_axes</span><span class="p">(</span><span class="s2">&quot;right&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="s2">&quot;5%&quot;</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">cax</span><span class="o">=</span><span class="n">cax</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Number of counts&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;X axis (array index)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Y axis (array index)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;MASK extension&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 1.0, &#39;MASK extension&#39;)
</pre></div>
</div>
<img alt="../../_images/5050e73d1321a94a74d9d133924623f9feb02f3e855b7784eeb547d9a09ec3e0.png" src="../../_images/5050e73d1321a94a74d9d133924623f9feb02f3e855b7784eeb547d9a09ec3e0.png" />
</div>
</div>
<p>We duplicate the <code class="docutils literal notranslate"><span class="pre">ccdimage</span></code> object to store in it the result of applying the distortion C correction and the wavelength calibration.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ccdimage_wavecalib</span> <span class="o">=</span> <span class="n">ccdimage</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>We apply the distortion C correction and the wavelength calibration to the 3 extensions. In the case of the mask, we first convert it into real numbers, perform the wavelength calibration, and finally store it as a boolean array by setting to <code class="docutils literal notranslate"><span class="pre">True</span></code> the values greater than zero.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># apply C-distortion correction and wavelength calibration to PRIMARY extension</span>
<span class="n">ccdimage_wavecalib</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">wavecalib</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="n">ccdimage</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> 
    <span class="n">crval1</span><span class="o">=</span><span class="n">crval1</span><span class="p">,</span> 
    <span class="n">cdelt1</span><span class="o">=</span><span class="n">cdelt1</span><span class="p">,</span>
    <span class="n">disable_tqdm</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>

<span class="c1"># apply C-distortion correction and wavelength calibration to MASK extension</span>
<span class="n">ccdimage_wavecalib</span><span class="o">.</span><span class="n">mask</span> <span class="o">=</span> <span class="n">wavecalib</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="n">ccdimage</span><span class="o">.</span><span class="n">mask</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">),</span> 
    <span class="n">crval1</span><span class="o">=</span><span class="n">crval1</span><span class="p">,</span> 
    <span class="n">cdelt1</span><span class="o">=</span><span class="n">cdelt1</span><span class="p">,</span>
    <span class="n">disable_tqdm</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span>

<span class="c1"># apply C-distortion correction and wavelength calibration to UNCERT extension</span>
<span class="n">ccdimage_wavecalib</span><span class="o">.</span><span class="n">uncertainty</span><span class="o">.</span><span class="n">array</span> <span class="o">=</span> <span class="n">wavecalib</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="n">ccdimage</span><span class="o">.</span><span class="n">uncertainty</span><span class="o">.</span><span class="n">array</span><span class="p">,</span>
    <span class="n">crval1</span><span class="o">=</span><span class="n">crval1</span><span class="p">,</span>
    <span class="n">cdelt1</span><span class="o">=</span><span class="n">cdelt1</span><span class="p">,</span>
    <span class="n">disable_tqdm</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&gt;&gt;&gt; Using CDELT1: 1 pix
&gt;&gt;&gt; Using CRVAL1: 6502.0 Angstrom
&gt;&gt;&gt; Using CDELT1: 0.39 Angstrom / pix
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "d4a213a17d9f4e16b85687d12f30258a"}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&gt;&gt;&gt; Using CDELT1: 1 pix
&gt;&gt;&gt; Using CRVAL1: 6502.0 Angstrom
&gt;&gt;&gt; Using CDELT1: 0.39 Angstrom / pix
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "53f27252523945249dd1d507faf9246d"}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&gt;&gt;&gt; Using CDELT1: 1 pix
&gt;&gt;&gt; Using CRVAL1: 6502.0 Angstrom
&gt;&gt;&gt; Using CDELT1: 0.39 Angstrom / pix
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "189c85677df24449af4cfb6836a7455d"}</script></div>
</div>
<p>We show the result before / after applying the calibration on the <code class="docutils literal notranslate"><span class="pre">PRIMARY</span></code> extension.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wavecalib</span><span class="o">.</span><span class="n">plot_data_comparison</span><span class="p">(</span>
    <span class="n">data_before</span><span class="o">=</span><span class="n">ccdimage</span><span class="o">.</span><span class="n">data</span><span class="p">,</span>
    <span class="n">data_after</span><span class="o">=</span><span class="n">ccdimage_wavecalib</span><span class="o">.</span><span class="n">data</span><span class="p">,</span>
    <span class="n">crval1</span><span class="o">=</span><span class="n">crval1</span><span class="p">,</span>
    <span class="n">cdelt1</span><span class="o">=</span><span class="n">cdelt1</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Primary HDU of </span><span class="si">{</span><span class="n">input_filename</span><span class="si">}</span><span class="s1">&#39;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/10723507a170146288b7e2e95845202b970e814944fa8116426b5399690ee939.png" src="../../_images/10723507a170146288b7e2e95845202b970e814944fa8116426b5399690ee939.png" />
<img alt="../../_images/2d97c5526e99da49b754b72ddc3d2e763669dc32b348dfdcb5ce4106418d86e6.png" src="../../_images/2d97c5526e99da49b754b72ddc3d2e763669dc32b348dfdcb5ce4106418d86e6.png" />
<img alt="../../_images/9dfc41be14b187307abc421b0cf33615a230007fc31d7c202fb20fcfd8804198.png" src="../../_images/9dfc41be14b187307abc421b0cf33615a230007fc31d7c202fb20fcfd8804198.png" />
<img alt="../../_images/2a89a0ce73b0e437ff116f6e6bc783ff382f979c8f560eb3016baa99d072cd4b.png" src="../../_images/2a89a0ce73b0e437ff116f6e6bc783ff382f979c8f560eb3016baa99d072cd4b.png" />
<img alt="../../_images/b66954104ab779d4c38181c522f57118d6f24224fce342356916e4d5fba3b06e.png" src="../../_images/b66954104ab779d4c38181c522f57118d6f24224fce342356916e4d5fba3b06e.png" />
<img alt="../../_images/75b52c8fa257097760fe802efb87c13cf56d880689dbf7e940f54aab739942f2.png" src="../../_images/75b52c8fa257097760fe802efb87c13cf56d880689dbf7e940f54aab739942f2.png" />
<img alt="../../_images/47ace47ad1697bea8ce8d34e05890aca319476dccb174b3b5f0dde10b464bb1c.png" src="../../_images/47ace47ad1697bea8ce8d34e05890aca319476dccb174b3b5f0dde10b464bb1c.png" />
<img alt="../../_images/1ae4aedd7568ee62d4b544c495f46304ae7f4b6b59ee52ed51197ce2ea08dcd9.png" src="../../_images/1ae4aedd7568ee62d4b544c495f46304ae7f4b6b59ee52ed51197ce2ea08dcd9.png" />
</div>
</div>
<p>We show the result before / after applying the calibration on the <code class="docutils literal notranslate"><span class="pre">MASK</span></code> extension.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wavecalib</span><span class="o">.</span><span class="n">plot_data_comparison</span><span class="p">(</span>
    <span class="n">data_before</span><span class="o">=</span><span class="n">ccdimage</span><span class="o">.</span><span class="n">mask</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">),</span>
    <span class="n">data_after</span><span class="o">=</span><span class="n">ccdimage_wavecalib</span><span class="o">.</span><span class="n">mask</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">),</span>
    <span class="n">crval1</span><span class="o">=</span><span class="n">crval1</span><span class="p">,</span>
    <span class="n">cdelt1</span><span class="o">=</span><span class="n">cdelt1</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;MASK extension of </span><span class="si">{</span><span class="n">input_filename</span><span class="si">}</span><span class="s1">&#39;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/df9a08fe2897ff19e19af9d1e6a652b85d5fa49163e08b5e03c31ce3a3ee4d9b.png" src="../../_images/df9a08fe2897ff19e19af9d1e6a652b85d5fa49163e08b5e03c31ce3a3ee4d9b.png" />
<img alt="../../_images/66c2bfa69a023ddb0522def436d963065bda86e6fda2a11ee66167777690c57d.png" src="../../_images/66c2bfa69a023ddb0522def436d963065bda86e6fda2a11ee66167777690c57d.png" />
<img alt="../../_images/512602a1ce550d46e334975b4c20635648e7bb230dcd09a46397d35a0758c878.png" src="../../_images/512602a1ce550d46e334975b4c20635648e7bb230dcd09a46397d35a0758c878.png" />
<img alt="../../_images/e45bea5571a80820e3c773b7d327e7c71a4d22f9e679f5a86935549e4e927a5d.png" src="../../_images/e45bea5571a80820e3c773b7d327e7c71a4d22f9e679f5a86935549e4e927a5d.png" />
<img alt="../../_images/4dfdfacfcd4b4a2c9f8dd27f062f709cab097d5338e2e19e90a2f9857311700e.png" src="../../_images/4dfdfacfcd4b4a2c9f8dd27f062f709cab097d5338e2e19e90a2f9857311700e.png" />
<img alt="../../_images/90cad0196ca5612f5cf98865999ac0ad5c6c7cfe1448ddc89b52613a1b7c4733.png" src="../../_images/90cad0196ca5612f5cf98865999ac0ad5c6c7cfe1448ddc89b52613a1b7c4733.png" />
<img alt="../../_images/7bea4bf71aaf66e1ecf3e9e538879f4e5ac7d4ba1aa8b2bc3294e0f1ca8dd23d.png" src="../../_images/7bea4bf71aaf66e1ecf3e9e538879f4e5ac7d4ba1aa8b2bc3294e0f1ca8dd23d.png" />
<img alt="../../_images/18be8ccec634aed8af3fa5a002611f3fe34c3b7ab104cd1802e75eb2a90d6d91.png" src="../../_images/18be8ccec634aed8af3fa5a002611f3fe34c3b7ab104cd1802e75eb2a90d6d91.png" />
</div>
</div>
<p>We show the result before / after applying the calibration on the <code class="docutils literal notranslate"><span class="pre">UNCERT</span></code> extension (<strong>we emphasize that from this point on, the errors stored in this array will be correlated</strong>).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wavecalib</span><span class="o">.</span><span class="n">plot_data_comparison</span><span class="p">(</span>
    <span class="n">data_before</span><span class="o">=</span><span class="n">ccdimage</span><span class="o">.</span><span class="n">uncertainty</span><span class="o">.</span><span class="n">array</span><span class="p">,</span>
    <span class="n">data_after</span><span class="o">=</span><span class="n">ccdimage_wavecalib</span><span class="o">.</span><span class="n">uncertainty</span><span class="o">.</span><span class="n">array</span><span class="p">,</span>
    <span class="n">crval1</span><span class="o">=</span><span class="n">crval1</span><span class="p">,</span>
    <span class="n">cdelt1</span><span class="o">=</span><span class="n">cdelt1</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;UNCERT extension of </span><span class="si">{</span><span class="n">input_filename</span><span class="si">}</span><span class="s1">&#39;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/37700ddd3b6bca46e4957b9b548b218abfc80534c6c7950c04ea95ca41e16b9f.png" src="../../_images/37700ddd3b6bca46e4957b9b548b218abfc80534c6c7950c04ea95ca41e16b9f.png" />
<img alt="../../_images/d9b4d88ac06326dd09b222498370e78b30b6edd4746a7fb8bb7f22c07266eed1.png" src="../../_images/d9b4d88ac06326dd09b222498370e78b30b6edd4746a7fb8bb7f22c07266eed1.png" />
<img alt="../../_images/de062bb58aed78a25f458f26eb855351a1fdf15f1b5ea3bf0723d4b3d9e45ad1.png" src="../../_images/de062bb58aed78a25f458f26eb855351a1fdf15f1b5ea3bf0723d4b3d9e45ad1.png" />
<img alt="../../_images/7b708ecca26d21042c9129beae4a9ef6ad5ff4008f9a555f37b65dc844c9498a.png" src="../../_images/7b708ecca26d21042c9129beae4a9ef6ad5ff4008f9a555f37b65dc844c9498a.png" />
<img alt="../../_images/2cf5b51520dd004d7b5bae5e621d755c64c9b14e63f067979146d5d720aeb112.png" src="../../_images/2cf5b51520dd004d7b5bae5e621d755c64c9b14e63f067979146d5d720aeb112.png" />
<img alt="../../_images/45e698c3cc16924585fa7ed2ed93af2138d83806bfbcacb819f713aea10f6172.png" src="../../_images/45e698c3cc16924585fa7ed2ed93af2138d83806bfbcacb819f713aea10f6172.png" />
<img alt="../../_images/fb39a9ca776b763793b8aa60cdf8c7f2820c3779a71430d900713f6ddb97f0ee.png" src="../../_images/fb39a9ca776b763793b8aa60cdf8c7f2820c3779a71430d900713f6ddb97f0ee.png" />
<img alt="../../_images/bbdbf7126846225eef1555b60fe509f974fe4759ce5dd98e66ee88621153c469.png" src="../../_images/bbdbf7126846225eef1555b60fe509f974fe4759ce5dd98e66ee88621153c469.png" />
</div>
</div>
<p>We finally save the resulting <code class="docutils literal notranslate"><span class="pre">CCDData</span></code> object.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># include wavelength calibration parameters</span>
<span class="n">ccdimage_wavecalib</span><span class="o">.</span><span class="n">header</span><span class="p">[</span><span class="s1">&#39;CRPIX1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">u</span><span class="o">.</span><span class="n">pixel</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">ccdimage_wavecalib</span><span class="o">.</span><span class="n">header</span><span class="p">[</span><span class="s1">&#39;CRVAL1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">crval1</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">crval1</span><span class="o">.</span><span class="n">unit</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">ccdimage_wavecalib</span><span class="o">.</span><span class="n">header</span><span class="p">[</span><span class="s1">&#39;CDELT1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">cdelt1</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">cdelt1</span><span class="o">.</span><span class="n">unit</span><span class="si">}</span><span class="s1">&#39;</span> <span class="p">)</span>
<span class="n">ccdimage_wavecalib</span><span class="o">.</span><span class="n">header</span><span class="p">[</span><span class="s1">&#39;CUNIT1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">crval1</span><span class="o">.</span><span class="n">unit</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;wavelength unit&#39;</span><span class="p">)</span>
<span class="n">ccdimage_wavecalib</span><span class="o">.</span><span class="n">header</span><span class="p">[</span><span class="s1">&#39;CTYPE1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;AWAV&#39;</span><span class="p">,</span> <span class="s1">&#39;air wavelength&#39;</span><span class="p">)</span>   

<span class="c1"># update FILENAME keyword with output file name</span>
<span class="n">output_filename</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;w</span><span class="si">{</span><span class="n">input_filename</span><span class="si">}</span><span class="s1">&#39;</span>
<span class="n">ccdimage_wavecalib</span><span class="o">.</span><span class="n">header</span><span class="p">[</span><span class="s1">&#39;FILENAME&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">output_filename</span>
<span class="c1"># update HISTORY in header</span>
<span class="n">ccdimage_wavecalib</span><span class="o">.</span><span class="n">header</span><span class="p">[</span><span class="s1">&#39;HISTORY&#39;</span><span class="p">]</span>  <span class="o">=</span> <span class="s1">&#39;-------------------&#39;</span>
<span class="n">ccdimage_wavecalib</span><span class="o">.</span><span class="n">header</span><span class="p">[</span><span class="s1">&#39;HISTORY&#39;</span><span class="p">]</span>  <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1"> %H:%M:%S&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="n">ccdimage_wavecalib</span><span class="o">.</span><span class="n">header</span><span class="p">[</span><span class="s1">&#39;HISTORY&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;using tea_wavecal&#39;</span>
<span class="n">ccdimage_wavecalib</span><span class="o">.</span><span class="n">header</span><span class="p">[</span><span class="s1">&#39;HISTORY&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;calibration file: </span><span class="si">{</span><span class="n">wavecal_filename</span><span class="si">}</span><span class="s1">&#39;</span>

<span class="c1"># save result</span>
<span class="n">ccdimage_wavecalib</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">output_filename</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="s1">&#39;yes&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Output file name.: </span><span class="si">{</span><span class="n">output_filename</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Output file name.: wftdz_45324.fits
</pre></div>
</div>
</div>
</div>
<section id="auxiliary-function-apply-wavecal-ccddata">
<h3>Auxiliary function <code class="docutils literal notranslate"><span class="pre">apply_wavecal_ccddata()</span></code><a class="headerlink" href="#auxiliary-function-apply-wavecal-ccddata" title="Link to this heading">#</a></h3>
<p>We have defined an auxiliary function called <code class="docutils literal notranslate"><span class="pre">apply_wavecal_ccddata()</span></code> that facilitates the application of wavelength calibration on FITS files that store <code class="docutils literal notranslate"><span class="pre">CCDData</span></code> objects.</p>
<p>For example, we can calibrate the previous image, stored in</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">input_filename</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ftdz_45324.fits
</pre></div>
</div>
</div>
</div>
<p>using the wavelength calibration stored in</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">wavecal_filename</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>wavecal_ftdz_45324.fits
</pre></div>
</div>
</div>
</div>
<p>and saving the result in</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">output_filename</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;ww</span><span class="si">{</span><span class="n">input_filename</span><span class="si">}</span><span class="s1">&#39;</span>
<span class="nb">print</span><span class="p">(</span><span class="n">output_filename</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>wwftdz_45324.fits
</pre></div>
</div>
</div>
</div>
<p>We will use the following parameters for the calibrated image:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">crval1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cdelt1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>6502.0 Angstrom
0.39 Angstrom / pix
</pre></div>
</div>
</div>
</div>
<p>The function <code class="docutils literal notranslate"><span class="pre">apply_wavecal_ccdata()</span></code> is executed easily by including the above information</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tea</span><span class="o">.</span><span class="n">apply_wavecal_ccddata</span><span class="p">(</span>
    <span class="n">infile</span><span class="o">=</span><span class="n">input_filename</span><span class="p">,</span>
    <span class="n">wcalibfile</span><span class="o">=</span><span class="n">wavecal_filename</span><span class="p">,</span>
    <span class="n">outfile</span><span class="o">=</span><span class="n">output_filename</span><span class="p">,</span>
    <span class="n">crval1</span><span class="o">=</span><span class="n">crval1</span><span class="p">,</span>
    <span class="n">cdelt1</span><span class="o">=</span><span class="n">cdelt1</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>By default, the function runs in “silent” mode (without displaying informational messages), so if we need to apply it automatically to many images, it won’t generate too many messages. If preferred, we can get some <em>feedback</em> by setting <code class="docutils literal notranslate"><span class="pre">silent_mode=False</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tea</span><span class="o">.</span><span class="n">apply_wavecal_ccddata</span><span class="p">(</span>
    <span class="n">infile</span><span class="o">=</span><span class="n">input_filename</span><span class="p">,</span>
    <span class="n">wcalibfile</span><span class="o">=</span><span class="n">wavecal_filename</span><span class="p">,</span>
    <span class="n">outfile</span><span class="o">=</span><span class="n">output_filename</span><span class="p">,</span>
    <span class="n">crval1</span><span class="o">=</span><span class="n">crval1</span><span class="p">,</span>
    <span class="n">cdelt1</span><span class="o">=</span><span class="n">cdelt1</span><span class="p">,</span>
    <span class="n">silent_mode</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&gt;&gt;&gt; Reading file.........: wavecal_ftdz_45324.fits
&gt;&gt;&gt; minimum CRVAL1 linear: 6502.2803275485685 Angstrom
&gt;&gt;&gt; maximum CRMAX1 linear: 6900.851045180412 Angstrom
&gt;&gt;&gt; mean CDELT1..........: 0.38960969465478373 Angstrom

&gt;&gt;&gt; Reading file.........: ftdz_45324.fits

Applying calibration to primary HDU
&gt;&gt;&gt; Using CDELT1: 1 pix
&gt;&gt;&gt; Using CRVAL1: 6502.0 Angstrom
&gt;&gt;&gt; Using CDELT1: 0.39 Angstrom / pix
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "3bfd83c45df2477db3df2fdb3b0d542d"}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Applying calibration to MASK extension
&gt;&gt;&gt; Using CDELT1: 1 pix
&gt;&gt;&gt; Using CRVAL1: 6502.0 Angstrom
&gt;&gt;&gt; Using CDELT1: 0.39 Angstrom / pix
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "30989a0f5a9d4c4e96bb832ca61c1991"}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Applying calibration to UNCERT extension
&gt;&gt;&gt; Using CDELT1: 1 pix
&gt;&gt;&gt; Using CRVAL1: 6502.0 Angstrom
&gt;&gt;&gt; Using CDELT1: 0.39 Angstrom / pix
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "107141b2703149b88c3f21d367ff4b46"}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>--&gt; Output FITS file.....: wwftdz_45324.fits
</pre></div>
</div>
</div>
</div>
<p>We can also indicate that a graphical comparison is shown before / after running the calibration, using the parameter <code class="docutils literal notranslate"><span class="pre">plot_data_comparison</span></code>, which can take 3 values:</p>
<ul class="simple">
<li><p>0: draws nothing</p></li>
<li><p>1: compares the data arrays (primary extension)</p></li>
<li><p>2: compares the primary HDU and the two extensions (<code class="docutils literal notranslate"><span class="pre">MASK</span></code> and <code class="docutils literal notranslate"><span class="pre">UNCERT</span></code>)</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tea</span><span class="o">.</span><span class="n">apply_wavecal_ccddata</span><span class="p">(</span>
    <span class="n">infile</span><span class="o">=</span><span class="n">input_filename</span><span class="p">,</span>
    <span class="n">wcalibfile</span><span class="o">=</span><span class="n">wavecal_filename</span><span class="p">,</span>
    <span class="n">outfile</span><span class="o">=</span><span class="n">output_filename</span><span class="p">,</span>
    <span class="n">crval1</span><span class="o">=</span><span class="n">crval1</span><span class="p">,</span>
    <span class="n">cdelt1</span><span class="o">=</span><span class="n">cdelt1</span><span class="p">,</span>
    <span class="n">silent_mode</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">plot_data_comparison</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="n">input_filename</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&gt;&gt;&gt; Reading file.........: wavecal_ftdz_45324.fits
&gt;&gt;&gt; minimum CRVAL1 linear: 6502.2803275485685 Angstrom
&gt;&gt;&gt; maximum CRMAX1 linear: 6900.851045180412 Angstrom
&gt;&gt;&gt; mean CDELT1..........: 0.38960969465478373 Angstrom
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&gt;&gt;&gt; Reading file.........: ftdz_45324.fits
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Applying calibration to primary HDU
&gt;&gt;&gt; Using CDELT1: 1 pix
&gt;&gt;&gt; Using CRVAL1: 6502.0 Angstrom
&gt;&gt;&gt; Using CDELT1: 0.39 Angstrom / pix
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "688c1ecca5ba4ef6ac60abd4417c998f"}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Applying calibration to MASK extension
&gt;&gt;&gt; Using CDELT1: 1 pix
&gt;&gt;&gt; Using CRVAL1: 6502.0 Angstrom
&gt;&gt;&gt; Using CDELT1: 0.39 Angstrom / pix
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "916fd44bfc48480d8a21c66bc91d25e9"}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Applying calibration to UNCERT extension
&gt;&gt;&gt; Using CDELT1: 1 pix
&gt;&gt;&gt; Using CRVAL1: 6502.0 Angstrom
&gt;&gt;&gt; Using CDELT1: 0.39 Angstrom / pix
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "6b3d0ccabbdc45f6852653a1975edcbf"}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>--&gt; Output FITS file.....: wwftdz_45324.fits
* Comparing primary HDU data before / after calibration
</pre></div>
</div>
<img alt="../../_images/6b9a8d4c38eeadd990a434c315caf9787ec987f0c592f0225f709942346d6379.png" src="../../_images/6b9a8d4c38eeadd990a434c315caf9787ec987f0c592f0225f709942346d6379.png" />
<img alt="../../_images/0614fb9f35d7fb4cbf651f737046aff83533dfeffa4aa15e3b51c1531847fb8c.png" src="../../_images/0614fb9f35d7fb4cbf651f737046aff83533dfeffa4aa15e3b51c1531847fb8c.png" />
<img alt="../../_images/7cf8c833857557edab0870b701a818afc41952e99d99d9e8fa108f5069c22ec6.png" src="../../_images/7cf8c833857557edab0870b701a818afc41952e99d99d9e8fa108f5069c22ec6.png" />
<img alt="../../_images/8bf9f8c864626c2a359c827b5d77feafcb354f71c56d19bf6729c66f4be76227.png" src="../../_images/8bf9f8c864626c2a359c827b5d77feafcb354f71c56d19bf6729c66f4be76227.png" />
<img alt="../../_images/e1335ce8eeb190be714e5d67f5996721ed2fc4d5749eaf413703e099a7adf43e.png" src="../../_images/e1335ce8eeb190be714e5d67f5996721ed2fc4d5749eaf413703e099a7adf43e.png" />
<img alt="../../_images/274d9f2f4ec81f21f8568895b0e53e38e692a08707544d41fa31df7d3d3f845a.png" src="../../_images/274d9f2f4ec81f21f8568895b0e53e38e692a08707544d41fa31df7d3d3f845a.png" />
<img alt="../../_images/37a14d21204413b1576c91da8856f02cba5f74eeaa6dd027d5a5582df655ef8d.png" src="../../_images/37a14d21204413b1576c91da8856f02cba5f74eeaa6dd027d5a5582df655ef8d.png" />
<img alt="../../_images/a1f01c4f36f902ce731ba9eb84a215b7f75f1f71390816bb448692a5d8880eb7.png" src="../../_images/a1f01c4f36f902ce731ba9eb84a215b7f75f1f71390816bb448692a5d8880eb7.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">time_end</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
<span class="n">tea</span><span class="o">.</span><span class="n">elapsed_time</span><span class="p">(</span><span class="n">time_ini</span><span class="p">,</span> <span class="n">time_end</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>system...........: Linux
release..........: 6.11.0-1018-azure
machine..........: x86_64
node.............: runnervmwhb2z
Python executable: /usr/bin/python3
teareduce version: 0.4.9
Initial time.....: 2025-10-27 16:50:56.067898
Final time.......: 2025-10-27 16:51:31.976752
Elapsed time.....: 0:00:35.908854
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./notebooks/wavecalib"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../cr2images/cr2images.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Cosmic Ray Removal in Double Exposures</p>
      </div>
    </a>
    <a class="right-next"
       href="../adaptivespl/adaptivespl.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Adaptive spline fit</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#automatic-search-for-lines-of-interest-across-the-entire-image">Automatic search for lines of interest across the entire image.</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#wavelength-calibration-of-the-reference-spectrum">Wavelength Calibration of the Reference Spectrum</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#searching-for-the-lines-across-the-entire-image">Searching for the lines across the entire image</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fitting-the-c-distortion">Fitting the C distortion</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#partial-fits">Partial fits</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#wavelength-calibration-calculation-for-the-entire-image">Wavelength Calibration Calculation for the Entire Image</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reading-the-calibration-from-the-auxiliary-fits-file">Reading the Calibration from the Auxiliary FITS File</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#applying-the-wavelength-calibration">Applying the Wavelength Calibration</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#graphical-check">Graphical Check</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#numerical-check">Numerical Check</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#applying-the-calibration-to-a-ccddata-object">Applying the Calibration to a <code class="docutils literal notranslate"><span class="pre">CCDData</span></code> Object</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#auxiliary-function-apply-wavecal-ccddata">Auxiliary function <code class="docutils literal notranslate"><span class="pre">apply_wavecal_ccddata()</span></code></a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Nicolás Cardiel
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>